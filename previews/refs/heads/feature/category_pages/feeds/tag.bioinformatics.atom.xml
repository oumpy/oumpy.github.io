<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>大阪大学医学部 Python会 (テスト用ページ) - Bioinformatics</title><link href="/previews/refs/heads/feature/category_pages/" rel="alternate"></link><link href="/previews/refs/heads/feature/category_pages/feeds/tag.bioinformatics.atom.xml" rel="self"></link><id>/previews/refs/heads/feature/category_pages/</id><updated>2019-12-23T00:00:00+09:00</updated><subtitle>Now is better than never.</subtitle><entry><title>バイオインフォマティクス技術者認定試験2019 解答速報？</title><link href="/previews/refs/heads/feature/category_pages/blog/2019/12/bioinfoexam2019_answer.html" rel="alternate"></link><published>2019-12-11T00:00:00+09:00</published><updated>2019-12-23T00:00:00+09:00</updated><author><name>小川</name></author><id>tag:None,2019-12-11:/previews/refs/heads/feature/category_pages/blog/2019/12/bioinfoexam2019_answer.html</id><summary type="html">&lt;p&gt;先日受験したバイオインフォマティクス認定試験をあらためて復習して、ついでに解答速報（全然速くない）と備忘録程度の解説を書きました。&lt;/p&gt;</summary><content type="html">&lt;p&gt;先日受験したバイオインフォマティクス認定試験をあらためて復習して、ついでに解答速報（全然速くない）と備忘録程度の解説を書きました。&lt;/p&gt;
&lt;h2&gt;模範解答 (?)&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;1&lt;/th&gt;
&lt;th&gt;2&lt;/th&gt;
&lt;th&gt;3&lt;/th&gt;
&lt;th&gt;4&lt;/th&gt;
&lt;th&gt;5&lt;/th&gt;
&lt;th&gt;6&lt;/th&gt;
&lt;th&gt;7&lt;/th&gt;
&lt;th&gt;8&lt;/th&gt;
&lt;th&gt;9&lt;/th&gt;
&lt;th&gt;10&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;0&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;10&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;20&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;30&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;40&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;50&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;60&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;70&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;&lt;em&gt;4&lt;/em&gt;&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;(問題番号 = 縦列番号 + 横列番号)&lt;/p&gt;
&lt;p&gt;(2019.12.23 公式解答と全問一致でした。ただ問74は取消になりませんでした。)&lt;/p&gt;
&lt;h2&gt;解説&lt;/h2&gt;
&lt;h3&gt;バイオ（問1-20）&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;問1：答4：はい&lt;/li&gt;
&lt;li&gt;問2：答4：核小体で合成されるのはrRNA。なおさらにリボソームの組み立ても行われる。&lt;/li&gt;
&lt;li&gt;問3：答3：G1→S→G2なのでG2で倍になっている。&lt;/li&gt;
&lt;li&gt;問4：答3：mRNAにポリAが付加されるのは真核生物。
  （注：教科書的には多分そうなのだが、原核生物やミトコンドリアのmRNAでも大抵はポリA鎖が見られるらしい。ただ持たない例もあり、二次的に失われたと考えられている。一方、真核生物でそのような例は知られていない。いずれにせよ一般に正しいとまでは言えないという意味で、選択肢3が正解となる。消去法的に解けるとはいえ、実は難問。）&lt;/li&gt;
&lt;li&gt;問5：答2：リボソームの小サブユニットは1種、大サブユニットは真核で3種、原核（真正および古細菌）で2種のrRNAを含む。よって合計4種ないし3種である。&lt;/li&gt;
&lt;li&gt;問6：答2：ジスルフィド結合でなくリン酸エステル結合。&lt;/li&gt;
&lt;li&gt;問7：答4：引っ掛けに近いが、グリシンの側鎖はHのみである。&lt;/li&gt;
&lt;li&gt;問8：答1：1回膜貫通で普通チャネルはできない。&lt;/li&gt;
&lt;li&gt;問9：答2：ユビキチンはタンパク質なので糖鎖修飾ではない。&lt;/li&gt;
&lt;li&gt;問10：答2：これもちょっとした引っ掛け。解糖系で酸素は消費しない。&lt;/li&gt;
&lt;li&gt;問11：答2：はい&lt;/li&gt;
&lt;li&gt;問12：答1：はい&lt;/li&gt;
&lt;li&gt;問13：答3：ミトコンドリアは母親由来である。&lt;/li&gt;
&lt;li&gt;問14：答3：グリセリンはアミノ酸ですらない。Gはグリシン。&lt;/li&gt;
&lt;li&gt;問15：答4：プロモータ領域にあるGC含量の高い領域はGCボックスという。LINEはレトロトランスポゾンの一種。問62でも登場。&lt;/li&gt;
&lt;li&gt;問16：答2：PCRで変化させるのは溶液組成ではなく温度である。&lt;/li&gt;
&lt;li&gt;問17：答4：メタボローム解析とはその名の通り、低分子化合物を主とする代謝産物の網羅的解析である。DNAの配列決定とは無関係。&lt;/li&gt;
&lt;li&gt;問18：答3：はい&lt;/li&gt;
&lt;li&gt;問19：答1：2,3,4は正しいので消去法で決めることができる。&lt;/li&gt;
&lt;li&gt;問20：答3：はい&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;インフォマティクス（問21-40）&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;問21：答3：偶奇を決める演算を問われている。該当するのはXORしかない。&lt;/li&gt;
&lt;li&gt;問22：答4：GPGPUの省略前名称を与えてくれており、これが説明と矛盾することは知らなくてもわかる。GPGPUの本当の意味は名前の通りだが、特に現在のカジュアルな深層学習には必須の技術である（そのうち専用プロセッサが主流となれば死語になるかもしれない）。&lt;/li&gt;
&lt;li&gt;問23：答2：はい&lt;/li&gt;
&lt;li&gt;問24：答2：はい&lt;/li&gt;
&lt;li&gt;問25：答4：はい&lt;/li&gt;
&lt;li&gt;問26：答1：while中の条件&lt;code&gt;x&amp;lt;A[j]&lt;/code&gt;が満たされることは決してない。よって&lt;code&gt;i&lt;/code&gt;のループが&lt;code&gt;2&lt;/code&gt;から&lt;code&gt;n&lt;/code&gt;まで一巡するだけで終了するので、計算量は&lt;span class="math"&gt;\(\Theta(n)\)&lt;/span&gt;である。&lt;/li&gt;
&lt;li&gt;問27：答2：マージソートを知らなくても、&lt;span class="math"&gt;\(f(n) = n + 2f(n/2)\)&lt;/span&gt; をただ解くだけでよい。&lt;span class="math"&gt;\(f(n)=n\log_2 n\)&lt;/span&gt; はこの厳密解となるので、計算量オーダーは &lt;span class="math"&gt;\(\Theta(n\log n)\)&lt;/span&gt; である。&lt;/li&gt;
&lt;li&gt;問28：答1：20n個の中の上位n個に入る確率は1/20であり、n依存性は消滅する。&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;問29：答4：順に辿ると、E &amp;lt; F &amp;lt; G &amp;lt; H になることがわかる。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;問30：答3：&lt;span class="math"&gt;\({}_5C_{2}=10\)&lt;/span&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;問31：答1：(i, j)に達する経路は(i-1, j)からと(i, j-1)からの2パターン。AtCoderのD問題以上でも頻出。&lt;/li&gt;
&lt;li&gt;問32：答1：SQLはRDB用の言語。&lt;/li&gt;
&lt;li&gt;問33：答1：論理演算を注意深く考えれば良い。&lt;/li&gt;
&lt;li&gt;問34：答2：はい&lt;/li&gt;
&lt;li&gt;問35：答1：-1から2までfを積分すればよいので、原始関数を使うと選択肢1が自動的に出る。&lt;/li&gt;
&lt;li&gt;問36：答2：どちらも負の相関があるが、x-yグラフの方がばらついている、つまり相関係数の絶対値が小さい。回帰直線の傾きは関係ない（引っ掛けである）。&lt;/li&gt;
&lt;li&gt;問37：答3：勾配ベクトルは軌跡に接し、また等高線に直交する。向きが紛らわしいが、上り方向である。学習時の変分ベクトルは符号を変えて下り方向。&lt;/li&gt;
&lt;li&gt;問38：答4：はい&lt;/li&gt;
&lt;li&gt;問39：答1：隠れマルコフモデルがクラスタリングに使えるかわからなくても（実際僕は知らない）、2,3,4は明らかにクラスタリングに使えるアルゴリズムである。&lt;/li&gt;
&lt;li&gt;問40：答4：訓練用とテスト用が逆である。訓練用のデータはなるべく多く確保したい。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;バイオインフォマティクス（問41-80）&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;問41：答3：菌種によらず共通に必要な機能は多く存在する。それらを1菌種にまとめるようなことをしてはいけない。&lt;/li&gt;
&lt;li&gt;問42：答4：はい&lt;/li&gt;
&lt;li&gt;問43：答4：書いているかどうかチェックするだけ。選択肢4のようなことは書いていない。&lt;/li&gt;
&lt;li&gt;問44：答3：4塩基分前後にずれたところ（右下と左上）にも直線状プロットがなければならない。&lt;/li&gt;
&lt;li&gt;問45：答2：はい&lt;/li&gt;
&lt;li&gt;問46：答2：四角が表すのは代謝反応を触媒する酵素である。&lt;/li&gt;
&lt;li&gt;問47：答3：はい&lt;/li&gt;
&lt;li&gt;問48：答1：一般に次世代シークエンサは繰り返し配列を苦手とする。たとえ反復配列から多くのRNAが転写されていても、そこから「ゲノム上の反復配列」を復元するのは困難と思われる。&lt;/li&gt;
&lt;li&gt;問49：答4：シュードノットとは、2度ヘアピンで折り返して元と同じ向きに進むような構造。そもそも2塩基だけで作れるようなものではない。&lt;/li&gt;
&lt;li&gt;問50：答1：PAMスコア行列の計算は、まず近縁なタンパク質間の置換回数から変異確率行列（=マルコフ過程遷移行列）を求める。1/100の割合で置換=1PAM。これを行列積で&lt;span class="math"&gt;\(n\)&lt;/span&gt;乗した遷移行列から、対数オッズスコアを計算したものがPAM&lt;span class="math"&gt;\(n\)&lt;/span&gt;である。「様々なアミノ酸の物理化学的指標を組み合わせて評価」したものではない。&lt;/li&gt;
&lt;li&gt;問51：答2：P(G)は縦および横に足し算するだけ。結果は一致する（一致しなければおかしい）。次にP(T|G)は0.05/0.2=0.25となる。&lt;/li&gt;
&lt;li&gt;問52：答3：1文字目Gの出現確率がP(G)=0.2、P(T|G)=0.25、P(C|T)=0.06/0.3=0.2なので、掛け合わせれば0.01が出る。&lt;/li&gt;
&lt;li&gt;問53：答3：疎水性アミノ酸は5番目のI（イソロイシン）と10番目のV（バリン）なので、それらが内部に埋もれるものを探して選べばよい。&lt;/li&gt;
&lt;li&gt;問54：答1：配列同士を比較すると、残基2と11、3と10のペアがそれぞれセットで変異していることがわかる。よってこれら同士が隣接するものを探して選べばよい。&lt;/li&gt;
&lt;li&gt;問55：答3：意味の異なる文字や数字が隣接していても、ルールが明確であればプログラムによる判読は容易である。&lt;/li&gt;
&lt;li&gt;問56：答4：はい（見ればわかる）&lt;/li&gt;
&lt;li&gt;問57：答4：図中にMainly Beta-Beta Barrelと書かれている。&lt;/li&gt;
&lt;li&gt;問58：答4：一概にそのようなことは言えない。一般に立体構造は一次配列よりもよく保存される傾向があり、遠い昔に共通起源を持つタンパク質が分化したものである可能性もよく検討する必要がある。&lt;/li&gt;
&lt;li&gt;問59：答2：1,3,4は少なくとも正しいと思われるので、消去法で。&lt;/li&gt;
&lt;li&gt;問60：答3：はい&lt;/li&gt;
&lt;li&gt;問61：答1：超優性だけでは高々ヘテロ結合になるだけであり、1箇所に何種類もの変異を保持することはできない。&lt;/li&gt;
&lt;li&gt;問62：答3：AluはSINEの一種で、レトロトランスポゾンでありながら有効な逆転写酵素を持たない。&lt;/li&gt;
&lt;li&gt;問63：答2：機能的制約から、特異な構造を持つタンパク質があってもおかしくない。&lt;/li&gt;
&lt;li&gt;問64：答1：連鎖不平衡と遺伝的連鎖は違う場合がある。&lt;/li&gt;
&lt;li&gt;問65：答1：はい&lt;/li&gt;
&lt;li&gt;問66：答3：新しい枝を追加する場所の選択肢が7通りあるので、15x7=105である。一般には(2n-5)!!となる。&lt;/li&gt;
&lt;li&gt;問67：答4：変異が有利に働く場合なので、中立説での説明とは異なる。&lt;/li&gt;
&lt;li&gt;問68：答4：はい（何もかも間違い）&lt;/li&gt;
&lt;li&gt;問69：答2：はい&lt;/li&gt;
&lt;li&gt;問70：答1：自身を活性化するAを抑えるので、「増えることによりさらに増える」ことはない。&lt;/li&gt;
&lt;li&gt;問71：答1：はい&lt;/li&gt;
&lt;li&gt;問72：答2：通常、DNAメチル化は遺伝子発現の抑制に働く。&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;問73：答4：終止コドンはTAA、TAGと、TATでなくTGAである。正確に記憶していなくても、3つとも最初の2文字が共通ということはないこと、さらに2文字目と3文字目は両方プリンだったことなど、断片的な情報からも答えられるように作られた問題。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;問74：答4？：想定解答はおそらく4と思われるが、それも実は正しい模様（質量分析の情報が構造決定のために用いられる）。すると全選択肢が正しく、正答なしとなる。&lt;em&gt;全員正解扱いの可能性あり。&lt;/em&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;問75：答2：菌の割合を求めて細菌数に掛ければ各菌ごとの菌密度が求められ、菌Xの密度は試料Aで&lt;span class="math"&gt;\(1.0\times 10^5\)&lt;/span&gt; 、試料Bで &lt;span class="math"&gt;\(0.75\times 10^5\)&lt;/span&gt; となる。&lt;/li&gt;
&lt;li&gt;問76：答3：知らなくても、エントロピーという言葉がShannonのヒントになっている。&lt;/li&gt;
&lt;li&gt;問77：答4：タンパク質間相互作用があってもそれが元の遺伝子にフィードバックされるとは限らないため、一般に完全グラフになるというのは誤り。&lt;/li&gt;
&lt;li&gt;問78：答4：タンパク質とmRNAの量比を問題にしているので、直接は無関係な事象である。&lt;/li&gt;
&lt;li&gt;問79：答3：ポリクローナル抗体での解析で有意差が無かったのだから、これはおかしい。&lt;/li&gt;
&lt;li&gt;問80：答3：ベイジアンネットワーク推定ではループ構造が現れることはない。&lt;/li&gt;
&lt;/ul&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="Blog"></category><category term="Bioinformatics"></category></entry><entry><title>がんゲノム変異シグネチャー解析</title><link href="/previews/refs/heads/feature/category_pages/blog/2019/06/cancer_signature.html" rel="alternate"></link><published>2019-06-21T00:00:00+09:00</published><updated>2019-06-21T00:00:00+09:00</updated><author><name>山田</name></author><id>tag:None,2019-06-21:/previews/refs/heads/feature/category_pages/blog/2019/06/cancer_signature.html</id><summary type="html"></summary><content type="html">&lt;p&gt;がんゲノムの変異シグネチャーの推定にチャレンジしてみました。&lt;/p&gt;
&lt;p&gt;&lt;img src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/1.png" width="400px"&gt;&lt;/p&gt;
&lt;h2&gt;きっかけ&lt;/h2&gt;
&lt;p&gt;先日の遺伝学の講義にて、がんゲノムの変異シグネチャーを教えていただき、やり方も詳しく書かれていたので、挑戦してみました。&lt;/p&gt;
&lt;p&gt;講義ではRでしたので、Pythonでも同じ結果が得られるか、Pythonの勉強も兼ねての挑戦記録です。&lt;/p&gt;
&lt;h2&gt;がんゲノムの変異シグネチャーとは？？&lt;/h2&gt;
&lt;p&gt;&lt;img alt="2" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/2.png"&gt;&lt;/p&gt;
&lt;p&gt;（がんゲノム情報学　中谷先生のスライドより）&lt;/p&gt;
&lt;h2&gt;トピックモデルとは？？&lt;/h2&gt;
&lt;p&gt;&lt;img alt="3" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/3.png"&gt;&lt;/p&gt;
&lt;p&gt;（&lt;a href="https://www.albert2005.co.jp/knowledge/machine_learning/topic_model/about_topic_model"&gt;https://www.albert2005.co.jp/knowledge/machine_learning/topic_model/about_topic_model&lt;/a&gt;より）&lt;/p&gt;
&lt;h3&gt;がんゲノムの場合のトピックは？？&lt;/h3&gt;
&lt;p&gt;&lt;img alt="4" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/4.png"&gt;&lt;/p&gt;
&lt;p&gt;（がんゲノム情報学　中谷先生のスライドより）&lt;/p&gt;
&lt;p&gt;一塩基ごとの変異情報がまとめられたテキストがDocumentsとして、がんの原因となる要素を一つ一つの「topic」、変異シグネチャーとして、トピックモデルを用いて推定します。&lt;/p&gt;
&lt;h2&gt;解析の方法&lt;/h2&gt;
&lt;p&gt;&lt;img alt="5" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/5.png"&gt;&lt;/p&gt;
&lt;p&gt;（がんゲノム情報学　中谷先生のスライドより）&lt;/p&gt;
&lt;p&gt;データベースにある変異データには、&lt;br&gt;
ゲノムの位置、その位置における変異前の塩基配列、変異後の配列&lt;br&gt;
の情報が書かれています。&lt;/p&gt;
&lt;p&gt;そこから変異の情報を、C&amp;gt;T_AGのような形でテキストファイルにIDごとに記録していきます。&lt;br&gt;
鋳型鎖と相補鎖の関係より、&lt;strong&gt;変異前がCかTの側のみ&lt;/strong&gt; を集計します。（＊注1）&lt;/p&gt;
&lt;p&gt;その後、各IDごとに変異データのテキストファイルを集め、変異情報をDocumentsとして、トピック、変異シグネチャーを推定していきます。&lt;/p&gt;
&lt;h2&gt;使用したツール&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;pandas  &lt;/li&gt;
&lt;li&gt;
&lt;p&gt;matplotlib&lt;br&gt;
Pythonでおなじみのツールですね。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;biopython&lt;br&gt;
Python 用の計算機分子生物学パッケージです。&lt;br&gt;
核酸やアミノ酸の配列情報を扱うためのFASTAファイルの処理が簡単になります。&lt;br&gt;
（ドキュメントは読み切れていないので、いずれ読みたいです…）&lt;br&gt;
公式：&lt;a href="https://biopython.org/"&gt;https://biopython.org/&lt;/a&gt;&lt;br&gt;
参考：&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://qiita.com/sato32ha6/items/6b762b0d0314a5db7dc3"&gt;https://qiita.com/sato32ha6/items/6b762b0d0314a5db7dc3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://bi.biopapyrus.jp/python/biopython/seq.html"&gt;https://bi.biopapyrus.jp/python/biopython/seq.html&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;gensim（topicmodel）&lt;br&gt;
今回の核となるトピックモデルについてはこちらを使います。&lt;br&gt;
gensimは、様々なトピックモデルを実装したPythonライブラリです。&lt;br&gt;
"&lt;em&gt;topic modeling for humans&lt;/em&gt;"とあるように、実装が大変なトピックモデルを簡単に使うことができます。&lt;br&gt;
今回はその中でも、LDA（Latent Dirichlet Allocation）を用います。&lt;br&gt;
参考：&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.sejuku.net/blog/67863"&gt;https://www.sejuku.net/blog/67863&lt;/a&gt;&lt;br&gt;
gensimの使い方についてはこれが一番わかりやすかったです）　　　&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://www.machinelearningplus.com/nlp/topic-modeling-gensim-python/"&gt;https://www.machinelearningplus.com/nlp/topic-modeling-gensim-python/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;wordcloud&lt;br&gt;
matplotlib を利用して Word Cloud を作成できる Python ライブラリです。&lt;br&gt;
wordcloud自体は、文章中で出現頻度が高い単語を複数選び出し、その頻度に応じた大きさで図示する手法です。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;実践　〜解析〜&lt;/h2&gt;
&lt;h3&gt;COSMICとは？&lt;/h3&gt;
&lt;p&gt;（HP：https://cancer.sanger.ac.uk/cosmic/）&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;COSMIC, the Catalogue Of Somatic Mutations In Cancer, is the world’s largest and most comprehensive resource for exploring the impact of somatic mutations in human cancer.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;（公式サイトより）&lt;/p&gt;
&lt;p&gt;がんと関連する体細胞変異の情報を集積したデータベースです。&lt;/p&gt;
&lt;p&gt;今回はこちらにある変異データを解析の対象としています。&lt;/p&gt;
&lt;p&gt;参考：統合TV　&lt;a href="https://togotv.dbcls.jp/20180127.html"&gt;https://togotv.dbcls.jp/20180127.html&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;データのダウンロード&lt;/h3&gt;
&lt;p&gt;がんゲノムの変異データをCOSMCのサイトからダウンロードします。
- &lt;a href="https://cancer.sanger.ac.uk/cosmic/download"&gt;https://cancer.sanger.ac.uk/cosmic/download&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;データを無料でダウンロードするには、学生としての登録が必要でした。
今回は様々なデータの中でも、Non coding variantsのものを使いました。
&lt;img alt="6" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/6.png"&gt;&lt;/p&gt;
&lt;h3&gt;リファレンス配列の入手&lt;/h3&gt;
&lt;p&gt;今回はUCSCからhg38をダウンロードしました。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ wget http://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;こちらのフォーマットはfastaで、&lt;/p&gt;
&lt;p&gt;&lt;img alt="7" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/7.png"&gt;&lt;/p&gt;
&lt;p&gt;のような感じで並んでいます。&lt;/p&gt;
&lt;p&gt;配列にAやaなど、大文字と小文字が並んでいるのは、大文字の A, C, G, T はコード領域、小文字の a, c, g, t はコード領域以外を表します。&lt;/p&gt;
&lt;h3&gt;変異データを覗いてみる&lt;/h3&gt;
&lt;p&gt;COSMICから入手したデータがどんなフォーマットなのか見てみました。&lt;/p&gt;
&lt;p&gt;&lt;img alt="8" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/8.png"&gt;&lt;/p&gt;
&lt;p&gt;ここからサンプルID、ゲノムのposition、元の配列、変異後の配列、という形で抽出し手確認しました。&lt;/p&gt;
&lt;p&gt;&lt;img alt="9" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/9.png"&gt;&lt;/p&gt;
&lt;p&gt;公式サイトによると、変異データのフォーマットは以下のようになっているようです。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;[column number:label] Heading&lt;/strong&gt;&lt;br&gt;
&lt;strong&gt;[1:A] Sample name,Sample id,Tumour id&lt;/strong&gt; – A sample is an instance of a portion of a tumour being examined for mutations. The sample name can be derived from a number of sources. In many cases it originates from the cell line name. Other sources include names assigned by the annotators, or an incremented number assigned during an anonymisation process. A number of samples can be taken from a single tumour and a number of tumours can be obtained from one individual. A sample id is used to identify a sample within the COSMIC database. There can be multiple ids, if the same sample has been entered into the database multiple times from different papers.&lt;br&gt;
&lt;strong&gt;[4:D] Primary Site&lt;/strong&gt; – The primary tissue/cancer from which the sample originated. More details on the tissue classification are avaliable from &lt;a href="https://cancer.sanger.ac.uk/cell_lines/classification"&gt;here&lt;/a&gt;. In COSMIC we have standard classification system for tissue types and sub types because they vary a lot between different papers.&lt;br&gt;
&lt;strong&gt;[5:E] Site Subtype 1&lt;/strong&gt; – Further sub classification (level 1) of the samples tissue of origin.&lt;br&gt;
&lt;strong&gt;[6:F] Site Subtype 2&lt;/strong&gt; – Further sub classification (level 2) of the samples tissue of origin.&lt;br&gt;
&lt;strong&gt;[7:G] Site Subtype 3&lt;/strong&gt; – Further sub classification (level 3) of the samples tissue of origin.&lt;br&gt;
&lt;strong&gt;[8:H] Primary Histology&lt;/strong&gt; – The histological classification of the sample.&lt;br&gt;
&lt;strong&gt;[9:I] Histology Subtype 1&lt;/strong&gt; – Further histological classification (level 1) of the sample.&lt;br&gt;
&lt;strong&gt;[10:J] Histology Subtype 2&lt;/strong&gt; – Further histological classification (level 2) of the sample.&lt;br&gt;
&lt;strong&gt;[11:K] Histology Subtype 3&lt;/strong&gt; – Further histological classification (level 3) of the sample.&lt;br&gt;
&lt;strong&gt;[12:L] Mutation Id&lt;/strong&gt; – unique mutation identifier.&lt;br&gt;
&lt;strong&gt;[13:M] Zygosity&lt;/strong&gt; – Information on whether the mutation was reported to be homozygous , heterozygous or unknown within the sample.&lt;br&gt;
&lt;strong&gt;[14:N] GRCh&lt;/strong&gt; – The coordinate system used –&lt;br&gt;
38 = GRCh38/Hg38&lt;br&gt;
37 = GRCh37/Hg19&lt;br&gt;
&lt;strong&gt;[15:O] Genome position&lt;/strong&gt; – The genomic cooridnate of the mutation.&lt;br&gt;
&lt;strong&gt;[16:P] Mutation somatic status&lt;/strong&gt; – Information on whether the sample was reported to be Confirmed Somatic, Previously Reported or Variant of unknown origin –&lt;br&gt;
Confirmed Somatic = if the mutation has been confimed to be somatic in the experiment by sequencing both the tumour and a matched normal from the same patient.&lt;br&gt;
variant of unknown origin = when the mutation is known to be somatic but the tumour was sequenced without a matched normal.&lt;br&gt;
Previously observed = when the mutation has been reported as somatic previously but not in current paper.&lt;br&gt;
&lt;strong&gt;[17:Q] WT SEQ&lt;/strong&gt; – wild type sequence.&lt;br&gt;
&lt;strong&gt;[18:R] MUT SEQ&lt;/strong&gt; – Mutated sequence.&lt;br&gt;
&lt;strong&gt;[19:S] SNP&lt;/strong&gt; – All the known SNPs are flagged as ‘y’ defined by the 1000 genomes project, dbSNP and a panel of 378 normal (non-cancer) samples from Sanger CGP sequencing.&lt;br&gt;
&lt;strong&gt;[20:T] FATHMM_MKL_NON_CODING_SCORE&lt;/strong&gt; – FATHMM-MKL non-coding score. A p-value ranging from 0 to 1 where &amp;gt;= 0.7 is functionally significant.&lt;br&gt;
&lt;strong&gt;[21:U] FATHMM_MKL_NON_CODING_GROUPS&lt;/strong&gt; – FATHMM-MKL group classification. More details from &lt;a href="https://cancer.sanger.ac.uk/cosmic/analyses"&gt;here&lt;/a&gt;.&lt;br&gt;
&lt;strong&gt;[22:V] FATHMM_MKL_CODING_SCORE&lt;/strong&gt; – FATHMM-MKL coding score (p-value ranging from 0 to 1).&lt;br&gt;
&lt;strong&gt;[23:W] FATHMM_MKL_CODING_GROUPS&lt;/strong&gt; – FATHMM-MKL group classification (coding). More details from &lt;a href="https://cancer.sanger.ac.uk/cosmic/analyses"&gt;here&lt;/a&gt;.&lt;br&gt;
&lt;strong&gt;[24:X] Whole Genome Reseq&lt;/strong&gt; – if the enitre genome is sequenced.&lt;br&gt;
&lt;strong&gt;[25:Y] Whole_Exome&lt;/strong&gt; – if the enitre exome is sequenced.&lt;br&gt;
&lt;strong&gt;[26:Z] Id Study&lt;/strong&gt; – Lists the unique Ids of studies that have involved this non coding mutation.&lt;br&gt;
&lt;strong&gt;[27:AA] Pubmed_PMID&lt;/strong&gt; – The PUBMED ID for the paper that the sample was noted in.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;変異ファイルの処理&lt;/h3&gt;
&lt;p&gt;ここが一番苦労しました。。。&lt;/p&gt;
&lt;h4&gt;簡単な流れ&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;変異データをpandasで読み込む&lt;/li&gt;
&lt;li&gt;MUT_SEQについて、genome_positionからリファレンス配列を参照して、変異配列の前後の配列を探し出す&lt;/li&gt;
&lt;li&gt;DataFrameの新しいcolumnとして配列を追加していく&lt;/li&gt;
&lt;li&gt;ID_tumorごとに、配列の変異をテキストファイルに書き出していく。&lt;/li&gt;
&lt;li&gt;tumorごとの変異についてのテキストファイルをもとに、トピックモデルをgensimを使って作成する。&lt;/li&gt;
&lt;li&gt;可視化する。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;以下実際のコードです。&lt;/p&gt;
&lt;h4&gt;ライブラリのimport&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;Bio&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;SeqIO&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;re&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;COSMICの変異データをpandasでDataFrameとして読み込みます。&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;mut_file&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CosmicNCV.tsv&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;ref_fasta&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hg38.fa&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;df_cosmic&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mut_file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df_cut&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;df_cosmic&lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ID_SAMPLE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ID_tumour&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genome position&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WT_SEQ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;MUT_SEQ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;span class="n"&gt;df_cut&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="10" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/10.png"&gt;&lt;/p&gt;
&lt;p&gt;上記のようにDataFrameとしてきれいに読み込めました。&lt;/p&gt;
&lt;h4&gt;リファレンス配列の読み込み&lt;/h4&gt;
&lt;p&gt;ここではbiopythonを使って簡単に配列部分を取り出します。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#リファレンスファイルについて&lt;/span&gt;
&lt;span class="n"&gt;list_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="n"&gt;list_desc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="n"&gt;list_seq&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;&lt;span class="c1"&gt;#biopythonを用いて、idやdesc、seqを抽出&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;SeqIO&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ref_fasta&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;fasta&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="n"&gt;id_part&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;
&lt;span class="n"&gt;desc_part&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;description&lt;/span&gt;
&lt;span class="n"&gt;seq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;seq&lt;/span&gt;

&lt;span class="n"&gt;list_id&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id_part&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;list_desc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;desc_part&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;list_seq&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;塩基配列はlist_seqに入っています。&lt;/p&gt;
&lt;p&gt;&lt;img alt="11" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/11.png"&gt;&lt;/p&gt;
&lt;p&gt;全てリスト形式なので、&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;list_seq&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;49&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;list_desc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;49&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="mi"&gt;19829559&lt;/span&gt;

&lt;span class="n"&gt;chr3&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;のように各染色体ごとに見るこができます。&lt;/p&gt;
&lt;h4&gt;COSMICのdf（DataFrame）の操作&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;df_cutのgenome_positionについて、染色体番号とゲノムの位置に分割して新しいカラムとして追加します。&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#chr、genome position用の空のリストを作成&lt;/span&gt;

&lt;span class="n"&gt;list_cut_chr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="n"&gt;list_cut_pos&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;span class="n"&gt;list_cut_chr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;[:-]&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;df_cut&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genome position&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]))[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;list_cut_pos&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;[:-]&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;df_cut&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genome position&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]))[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="c1"&gt;#df_cutに新しいカラムとして追加。&lt;/span&gt;

&lt;span class="n"&gt;df_cut&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;chr&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Series&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;list_cut_chr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;df_cut&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;single position&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Series&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;list_cut_pos&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df_cut&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="12" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/12.png"&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;MUT_SEQの欠損値、chr23、24、25を除く。&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#mutのdfからchr23、24、MUT_SEQのnanを除く&lt;/span&gt;
&lt;span class="n"&gt;df_cut_chr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;df_cut&lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="n"&gt;df_cut&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;chr&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;23&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;amp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;amp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;chr&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;24&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;amp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;amp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;chr&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;25&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;df_cut_chr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dropna&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;subset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MUT_SEQ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;inplace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="c1"&gt;#indexを振り直す&lt;/span&gt;

&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reset_index&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;なぜかCOSMICのデータにchr22以上のものが含まれていたので、除きました。&lt;/p&gt;
&lt;h4&gt;リファレンス配列から、MUT_SEQの前後の配列を抽出&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#refから変異位置の前後の配列を抽出&lt;/span&gt;
&lt;span class="n"&gt;seq_before&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="n"&gt;seq_after&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;span class="n"&gt;seq_before&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;list_seq&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;list_id&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;chr&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;chr&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])][&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;single position&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;seq_after&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;list_seq&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;list_id&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;chr&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;chr&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])][&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;single position&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;COSMICのdfと合わせていく。&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;変異の前後の配列について、dfに追加し、大文字に直す&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_before&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Series&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seq_before&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_after&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Series&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seq_after&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="c1"&gt;#大文字に変更&lt;/span&gt;
&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_before&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_before&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;upper&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_after&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_after&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;upper&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;ol&gt;
&lt;li&gt;前、変異、後の3つの配列を新しいカラムの中に追加する
（以下のようなややこしいカラムを作っているのは（＊注1）のためです）&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#3文字の配列にする（seq_forwardが鋳型）&lt;/span&gt;
&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_forward&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_before&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MUT_SEQ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_after&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;#鋳型鎖の順番を逆にしたもの（相補鎖を作るため）&lt;/span&gt;
&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_forward_r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_after&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MUT_SEQ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_before&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ここまでで以下のようになります。（dfの右側だけ）&lt;/p&gt;
&lt;p&gt;&lt;img alt="13" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/13.png"&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;3つの配列について、相補鎖を作ります&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#辞書型で相補鎖に変換&lt;/span&gt;
&lt;span class="n"&gt;dict_base&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;A&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;G&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;G&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;A&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;list_seq_reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="n"&gt;list_wt_seq_reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;span class="n"&gt;list_seq_reverse&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_forward_r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;translate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;maketrans&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dict_base&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="c1"&gt;#次のために、変異の配列も変換しておきます。 list_wt_seq_reverse.append((str(df_cut_chr_i[&amp;#39;WT_SEQ&amp;#39;][i])).translate(str.maketrans(dict_base)))&lt;/span&gt;
&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_reverse&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Series&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;list_seq_reverse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WT_seq_reverse&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Series&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;list_wt_seq_reverse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;変異の情報をテキストファイルに書き出す&lt;/h4&gt;
&lt;p&gt;いよいよ最後のステップです。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#ID_tumorのカウント&lt;/span&gt;
&lt;span class="n"&gt;dict_tumor_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ID_tumour&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value_counts&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_dict&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="n"&gt;list_tumor_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dict_tumor_id&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;まずはIDをリストに格納します。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ID_tumour&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value_counts&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="14" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/14.png"&gt;&lt;/p&gt;
&lt;p&gt;（上はテストファイルで行ったため、実際の数値とは異なります。）&lt;/p&gt;
&lt;p&gt;いろいろな試行錯誤したコードで、テキストファイルに書き出していきます。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;df_index_for_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;list_tumor_id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;df_index_for_id&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;index_&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Series&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ID_tumour&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;df_index_for_id&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;index_&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)]:&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isnull&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="k"&gt;continue&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text_2/&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s2"&gt;.txt&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)])[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WT_SEQ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;C&amp;#39;&lt;/span&gt;&lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)])[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WT_SEQ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;T&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)])[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WT_SEQ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;amp;amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)])[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MUT_SEQ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;\
&lt;span class="s1"&gt;&amp;#39;_&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)])[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_forward&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;\
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)])[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_forward&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;elif&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)])[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WT_SEQ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;A&amp;#39;&lt;/span&gt;&lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)])[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WT_SEQ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;G&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)])[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WT_seq_reverse&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;amp;amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)])[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_reverse&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;\
&lt;span class="s1"&gt;&amp;#39;_&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)])[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_reverse&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;\
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_cut_chr_i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)])[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;seq_reverse&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="k"&gt;continue&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;（特に速度のことは考えずに直感的にforで回したので、かなり時間がかかります。）
ここまでで変異のデータをIDごとに抽出することができました！&lt;/p&gt;
&lt;p&gt;上のスクリプトをサーバーにでも投げてしばらく待ちます。&lt;/p&gt;
&lt;h3&gt;トピックモデルを使ってみる&lt;/h3&gt;
&lt;p&gt;&lt;img alt="15" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/15.png"&gt;&lt;/p&gt;
&lt;p&gt;4までの操作で各IDごとの上のように、変異データが得られました。&lt;/p&gt;
&lt;p&gt;これをトピックモデルを使って解析していきます。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;gensim&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;collections&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Counter&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wordcloud&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;WordCloud&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;ディレクトリ内のファイルリストを取得する&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;glob&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;

&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;chdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/Users/***/test/cancer_genome&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;list_file_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;glob&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;glob&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;./text_2/*&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;list_file_name&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;変異データを一つのリスト内に格納する&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;list_text&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;list_file_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readlines&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="k"&gt;continue&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;list_text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(((&lt;/span&gt;&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readlines&lt;/span&gt;&lt;span class="p"&gt;())[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;トピックモデル&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#辞書を作成&lt;/span&gt;
&lt;span class="n"&gt;dictionary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gensim&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;corpora&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Dictionary&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;list_text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;corpus&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;dictionary&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;doc2bow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;list_text&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;#トピックモデルの学習&lt;/span&gt;
&lt;span class="n"&gt;num_topics&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;

&lt;span class="n"&gt;lda&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gensim&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ldamodel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;LdaModel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="n"&gt;corpus&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;corpus&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="n"&gt;num_topics&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;num_topics&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="n"&gt;id2word&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;dictionary&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;トピック数（num_topics）については後述します。&lt;/p&gt;
&lt;p&gt;これでトピックモデルの学習ができました。ここは実行時間はそこまで長くありません。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;lda&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show_topic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="16" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/16.png"&gt;&lt;/p&gt;
&lt;p&gt;結果を見てみると、各トピックごとに、各変異がどれほどの割合を占めているのか、というのがわかります。&lt;/p&gt;
&lt;h4&gt;可視化&lt;/h4&gt;
&lt;p&gt;おなじみmatplotlibを使ってグラフにしてみます。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;collections&lt;/span&gt;

&lt;span class="n"&gt;clist&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;\
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;orange&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;orange&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;\
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="mi"&gt;48&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;green&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;\
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;49&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;salmon&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="mi"&gt;66&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;salmon&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;\
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;67&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="mi"&gt;83&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;\
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;84&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;black&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;black&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;rvb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mcolors&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;LinearSegmentedColormap&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;clist&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;dict_topic&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lda&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show_topic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dict_topic&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dict_topic&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt; &lt;span class="n"&gt;dict_topic&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;align&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;center&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;rvb&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xticks&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dict_topic&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dict_topic&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;()),&lt;/span&gt; &lt;span class="n"&gt;rotation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;90&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="17" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/17.png"&gt;&lt;/p&gt;
&lt;p&gt;リストで色を指定することで、このように変異の種類（T&amp;gt;C、T&amp;gt;A、C&amp;gt;Gなど）ごとに色づけすることができました。
- 参考：&lt;a href="https://stackoverflow.com/questions/42656585/barplot-colored-according-a-colormap"&gt;https://stackoverflow.com/questions/42656585/barplot-colored-according-a-colormap&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;これをトピックごとにグラフを作成し、画像として保存します。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;clist&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;aqua&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;aqua&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;\
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;black&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;black&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;\
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="mi"&gt;48&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;\
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;49&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;gray&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="mi"&gt;66&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;gray&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;\
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;67&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;lime&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="mi"&gt;83&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;lime&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;\
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;84&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;pink&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;pink&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;rvb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mcolors&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;LinearSegmentedColormap&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;clist&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lda&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;num_topics&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="c1"&gt;#plt.subplot(lda.num_topics,2,i+1)&lt;/span&gt;
&lt;span class="n"&gt;dict_topic&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lda&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show_topic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dict_topic&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;topic #&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dict_topic&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt; &lt;span class="n"&gt;dict_topic&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;align&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;center&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;rvb&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;102&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xticks&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dict_topic&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dict_topic&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;()),&lt;/span&gt; &lt;span class="n"&gt;rotation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;90&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;topic_pdf/topicmodel_ms_&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;.pdf&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;（色はCOSMICのグラフのものと揃えました）&lt;/p&gt;
&lt;p&gt;&lt;img alt="18" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/18.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="19" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/19.png"&gt;&lt;/p&gt;
&lt;h3&gt;データベースのシグネチャと比較&lt;/h3&gt;
&lt;p&gt;COSMICには、今までに推定されてきたがんゲノムの変異シグネチャーが多数登録されています。
- &lt;a href="https://cancer.sanger.ac.uk/cosmic/signatures/SBS/"&gt;https://cancer.sanger.ac.uk/cosmic/signatures/SBS/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="20" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/20.png"&gt;&lt;/p&gt;
&lt;p&gt;シグネチャーのグラフと、関連するがんの原因が示されています。&lt;/p&gt;
&lt;h4&gt;推定&lt;/h4&gt;
&lt;p&gt;今回の課題は、「&lt;strong&gt;たばこ/紫外線のシグネチャーを見つけることができたか&lt;/strong&gt;」でした。&lt;/p&gt;
&lt;p&gt;データベースにあるグラフとどれほど一致しているか見ていきます。&lt;/p&gt;
&lt;p&gt;COSMICに掲載されているシグネチャーSBS1〜SBS85までのうち、&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;たばこ&lt;/strong&gt;（tobacco）が原因とされるもの→SBS4、5、29&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;紫外線&lt;/strong&gt;（ultraviolet light）が原因とされるもの→SBS7a〜d、38&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="21" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/21.png"&gt;&lt;/p&gt;
&lt;p&gt;であるとわかりました。&lt;/p&gt;
&lt;h4&gt;推定結果&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;-たばこ-&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;①SBS4&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;COSMIC&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="22" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/22.png"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;推定&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="23" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/23.png"&gt;&lt;/p&gt;
&lt;p&gt;②SBS5&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;COSMIC&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="24" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/24.png"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;推定&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="25" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/25.png"&gt;&lt;/p&gt;
&lt;p&gt;③SBS29&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;COSMIC&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="26" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/26.png"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;推定&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="27" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/27.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;-紫外線-&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;①SBS7a
- COSMIC&lt;/p&gt;
&lt;p&gt;&lt;img alt="28" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/28.png"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;推定&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="29" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/29.png"&gt;&lt;/p&gt;
&lt;p&gt;②SBS7b&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;COSMIC&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="30" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/30.png"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;推定&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="31" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/31.png"&gt;&lt;/p&gt;
&lt;p&gt;③SBS7c&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;COSMIC&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="32" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/32.png"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;推定&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;類似しているシグネチャーは確認できませんでした。&lt;/p&gt;
&lt;p&gt;④SBS7d&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;COSMIC&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="33" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/33.png"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;推定&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;類似しているシグネチャーは確認できませんでした。&lt;/p&gt;
&lt;p&gt;⑤SBS38&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;COSMIC&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="34" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/34.png"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;推定&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;類似しているシグネチャーは確認できませんでした。&lt;/p&gt;
&lt;p&gt;どれも完全に一致しているとは言えないのですが、近いものはそれなりに類似しているグラフが作れたのではないかと思います。&lt;/p&gt;
&lt;p&gt;シグネチャーを見るだけでも、「たばこを原因とするがんは、変異の種類が多い」、「紫外線を原因とするがんは、変異の種類が少ない」という傾向も見て取れます。&lt;/p&gt;
&lt;h2&gt;おまけ -WordCloudによる可視化-&lt;/h2&gt;
&lt;p&gt;トピックモデルで単語を扱う際によく同時にやられているものとして、WordCloudがあったため、変異データでもやってみました。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lda&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;num_topics&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lda&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show_topic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;im&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;WordCloud&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;generate_from_frequencies&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;im&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;off&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Topic #&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="35" src="/previews/refs/heads/feature/category_pages/blog/2019/06/images/cancer_signature_figs/35.png"&gt;&lt;/p&gt;
&lt;h2&gt;今後やってみたいこと&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;がんゲノムの変異シグネチャーは、最初に発表された論文ではNon- negative Matrix Factorization(NMF)(非負値行列因子分解)を使って推定された。2019年になって「トピックモデル」を使って変異 シグネチャを推定する論文が二報発表された。&lt;br&gt;
1. Funnell, T. et al. Integrated structural variation and point mutation signatures in cancer genomes using correlated topic models. PLOS Computational Biology 15, e1006799 (2019).
2. Matsutani, T., Ueno, Y., Fukunaga, T. &amp;amp; Hamada, M. Discovering novel mutation signatures by latent Dirichlet allocation with variational Bayes inference. Bioinformatics doi:10.1093/bioinformatics/btz266&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;このような背景があったため今回はトピックモデルを使ってみたのですが、NMFを用いた推定もやってみたいです。&lt;/p&gt;
&lt;p&gt;変異シグネチャーの個数については、今回のセッティングが最適ではなく、丁寧にやるならhierarchical dirichlet process (HDP) を用いるか、perplexity、coherenceなどの評価指標を用いる必要があるのかと思いました。
- 参考：&lt;a href="https://www.randpy.tokyo/entry/word2vec_skip_gram_model"&gt;https://www.randpy.tokyo/entry/word2vec_skip_gram_model&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;参考&lt;/h2&gt;
&lt;p&gt;今回のコード、作成したグラフ等はGitHubにあります。
- &lt;a href="https://github.com/ykohki/cancer_signature"&gt;https://github.com/ykohki/cancer_signature&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;トピックモデルを用いたがんゲノムの変異シグネチャー解析
- &lt;a href="https://ipsj.ixsq.nii.ac.jp/ej/index.php?active_action=repository_view_main_item_detail&amp;amp;page_id=13&amp;amp;block_id=8&amp;amp;item_id=182433&amp;amp;item_no=1"&gt;https://ipsj.ixsq.nii.ac.jp/ej/index.php?active_action=repository_view_main_item_detail&amp;amp;page_id=13&amp;amp;block_id=8&amp;amp;item_id=182433&amp;amp;item_no=1&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;がんゲノムビッグデータから喫煙による遺伝子異常を同定
- &lt;a href="https://www.ncc.go.jp/jp/information/pr_release/2016/1104/index.html"&gt;https://www.ncc.go.jp/jp/information/pr_release/2016/1104/index.html&lt;/a&gt;
- &lt;a href="https://science.sciencemag.org/content/354/6312/618"&gt;https://science.sciencemag.org/content/354/6312/618&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;同じ変異シグネチャーについて調べていて、特にたばこについて見ている論文でした
- https://www.nature.com/articles/nature12477#associating-cancer-aetiology-and-mutational-signatures&lt;/p&gt;</content><category term="Blog"></category><category term="Bioinformatics"></category></entry><entry><title>VELOCYTO</title><link href="/previews/refs/heads/feature/category_pages/blog/2019/03/velocyto.html" rel="alternate"></link><published>2019-03-24T00:00:00+09:00</published><updated>2019-03-24T00:00:00+09:00</updated><author><name>廣瀬</name></author><id>tag:None,2019-03-24:/previews/refs/heads/feature/category_pages/blog/2019/03/velocyto.html</id><summary type="html"></summary><content type="html">&lt;p&gt;&lt;strong&gt;Velocyto&lt;/strong&gt; とは、RNAseq の結果に含まれるイントロンの割合からその細胞の分化指向性を算出するという解析手法です。&lt;/p&gt;
&lt;h2&gt;RNAseq でイントロン??&lt;/h2&gt;
&lt;p&gt;RNAseq においては totalRNA のうち 99%ともいわれる rRNA を除き mRNA のみを効率よくSequence する目的で、Poly(A)で成熟 mRNA を濃縮することがしばしば行われています。しかし、そのようなサンプルにおいても、実際の Sequence 結果ではイントロンにあたる配列が読まれてくることが指摘されており、この原因は Poly(A)類似モチーフの存在であると推察されています。&lt;/p&gt;
&lt;h2&gt;結果の例&lt;/h2&gt;
&lt;p&gt;概日時間の検討ではとてもきれいな結果が得られています。関連遺伝子のunspliced(u) とspliced(s)を観察していくと、circadian timeの経過とともにu がs に変化していきます。&lt;/p&gt;
&lt;p&gt;また、未分化細胞からの分化の方向性を見積もることも可能と報告されています。マウスのオリゴデンドロサイト前駆体細胞がオリゴデンドロサイトへ分化する方向に Velocityを持っていることが示されました。&lt;/p&gt;
&lt;h2&gt;実践編&lt;/h2&gt;
&lt;p&gt;Developer の WEB(&lt;a href="http://velocyto.org/"&gt;http://velocyto.org/&lt;/a&gt;)の tutorial を参考に手持ちの BAM で挑戦します。R 用と Python 用とあるようですが、もちろん Python です。二部構成となっており、前半はCommand lineでBAMファイルから.loomファイルを作成、後半では作成した.loomファイルから解析を行うとのことです。&lt;/p&gt;
&lt;h3&gt;準備&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ conda install numpy scipy cython numba matplotlib scikit-learn h5py click
$ pip install velocyto
$ pip install scanpy
$ pip install -U scvelo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;※pysam は Windows 環境下では仮想環境下であってもインストールできないそうです。
- &lt;a href="https://qiita.com/chaoi/items/6d7702cd70430610f844"&gt;https://qiita.com/chaoi/items/6d7702cd70430610f844&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;これに気付かず数日はまりました。。&lt;/p&gt;
&lt;h3&gt;Genome annotation file のダウンロード&lt;/h3&gt;
&lt;p&gt;GENCODE のサイトから GTF ファイルをダウンロードし、適当な場所に保存して
gunzip。&lt;/p&gt;
&lt;h3&gt;実行&lt;/h3&gt;
&lt;p&gt;Sequence の手法ごとに Command を選べます。今回は smart-seq2 で行います。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ velocyto run-smartseq2 -e hogehoge /*.bam annotation.gtf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;オプション&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-o, --outputfolder&lt;/code&gt;：出力ディレクトリを作成・指定&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-e, --sampleid&lt;/code&gt;：出力ファイル名&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-m, --repmask&lt;/code&gt;：リピート配列をマスクする場合&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-t, --dtype&lt;/code&gt;：出力ファイルのデータ型(default は unit32)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-d, --dump&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-v, --verbose&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;サンプルごとに BAM があることを想定して複数ファイルを*で受け付けてくれます。BAM と GTF ファイルは必須です。なお、BAM の代わりに SAM を入れてもエラーは吐かないようです。これにより、hogehoge.loom ファイルが得られました。この中には、各分子のスプライシング状態が格納されています。&lt;/p&gt;
&lt;p&gt;※TOPHAT でアラインメントしたデータはそのままではうまく行かないようです。なので、TopHat-Recondition で unmap のデータを拾ってくればいけるかもしれません。今回はHISAT2 でアラインメントし直してから velocyto をかけ、改めてhogehoge.loom ファイルを得ました。&lt;/p&gt;
&lt;h3&gt;描画&lt;/h3&gt;
&lt;p&gt;Scanpy と組み合わせて使用するために scvelo を用いました。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;scanpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;sc&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;scvelo&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;scv&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;データ読み込み&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;adata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;hogehoge.loom&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cache&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;次元圧縮&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;sc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pca&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adata&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n_comps&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;速度計算&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;scv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;moments&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adata&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;scv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;velocity&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adata&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;描画&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;scv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;velocity_embedding&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adata&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="1" src="/previews/refs/heads/feature/category_pages/blog/2019/03/images/velocyte_figs/picture1.png"&gt;&lt;/p&gt;
&lt;p&gt;※それぞれの細胞における特定遺伝子の発現レベルを色で表したり、PCA 以外の次元圧縮法を用いることもできます。この場合は tSNE のほうがきれいに見えるようです。パラメータはたくさん用意されているので、各データセットで最適な条件を検討する必要があるでしょう。&lt;/p&gt;
&lt;p&gt;&lt;img alt="2" src="/previews/refs/heads/feature/category_pages/blog/2019/03/images/velocyte_figs/picture2.png"&gt;
&lt;img alt="3" src="/previews/refs/heads/feature/category_pages/blog/2019/03/images/velocyte_figs/picture3.png"&gt;&lt;/p&gt;
&lt;h2&gt;参考文献&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.nature.com/articles/s41586-018-0414-6"&gt;https://www.nature.com/articles/s41586-018-0414-6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://velocyto.org/velocyto.py/index.html"&gt;http://velocyto.org/velocyto.py/index.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://catway.jp/bioinformatics/qc/rmrepeat.html"&gt;http://catway.jp/bioinformatics/qc/rmrepeat.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/theislab/scvelo"&gt;https://github.com/theislab/scvelo&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="Blog"></category><category term="Bioinformatics"></category></entry><entry><title>阪医Python会特製 RNA-seq pipeline ver. 1.0 リリース</title><link href="/previews/refs/heads/feature/category_pages/blog/2019/03/original_rnaseq_pipeline.html" rel="alternate"></link><published>2019-03-19T00:00:00+09:00</published><updated>2019-03-19T00:00:00+09:00</updated><author><name>菅波</name></author><id>tag:None,2019-03-19:/previews/refs/heads/feature/category_pages/blog/2019/03/original_rnaseq_pipeline.html</id><summary type="html"></summary><content type="html">&lt;p&gt;阪医Python会のbioinformaticsチームの一つの成果として、RNA-seqのパイプラインのv1.0がリリースとなったので記事とさせていただきます。SRR idから遺伝子✕サンプルのテーブルにするまでには意外に大変ですが、それをすべて自動化しました。ダウンロード、詳細等は以下にあります。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href="https://github.com/yyoshiaki/auto_counttable_maker"&gt;https://github.com/yyoshiaki/auto_counttable_maker&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;なお、以下のイラストはikraのアイコンとなっています。&lt;/p&gt;
&lt;p&gt;&lt;img src="/previews/refs/heads/feature/category_pages/blog/2019/03/images/original_rnaseq_pipeline_figs/ikra.png" width="250px"&gt; &lt;/p&gt;
&lt;h2&gt;特徴&lt;/h2&gt;
&lt;p&gt;今回、自分たちの使いやすさを考えてツールの設計を行いました。他サンプルのファイル名の管理など、煩わしいところをすべて自動化することで、ミスも減らせると思います。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;準備するのは簡単なCSVファイル（テーブルだけ）で、極力パラメーターを減らした。&lt;/li&gt;
&lt;li&gt;すべてdocker上で動くため、ツールを各々インストールする必要がないし、バージョンに苦しむこともない。&lt;/li&gt;
&lt;li&gt;udockerにも対応しているため、ユーザー権限しかないサーバー上でも実行可能。&lt;/li&gt;
&lt;li&gt;outputは&lt;a href="http://bioinformatics.sdstate.edu/idep/"&gt;idep&lt;/a&gt;に対応。&lt;/li&gt;
&lt;li&gt;もちろんマルチスレッド対応。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;使い方&lt;/h2&gt;
&lt;p&gt;必要なテーブルは&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;name&lt;/th&gt;
&lt;th&gt;SRR or fastq&lt;/th&gt;
&lt;th&gt;Layout&lt;/th&gt;
&lt;th&gt;condition1&lt;/th&gt;
&lt;th&gt;...&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Treg_LN_1&lt;/td&gt;
&lt;td&gt;SRR5385247&lt;/td&gt;
&lt;td&gt;SE&lt;/td&gt;
&lt;td&gt;Treg&lt;/td&gt;
&lt;td&gt;...&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Treg_LN_2&lt;/td&gt;
&lt;td&gt;SRR5385248&lt;/td&gt;
&lt;td&gt;SE&lt;/td&gt;
&lt;td&gt;Treg&lt;/td&gt;
&lt;td&gt;...&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;のような形式で、前3列が必須です。簡単ですね！データの集め方は、論文についているaccession number等をたどるのでもいいし、新しくなって爆速になった&lt;a href="http://sra.dbcls.jp/"&gt;DDBJ Search&lt;/a&gt;もおすすめ。&lt;/p&gt;
&lt;p&gt;コマンドはオプションが指定でき、リード数を100000に絞ったテストモードやマルチプロセスにも対応。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;Usage&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bash&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MakeCountTable_Illumina_trimgalore_SRR&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sh&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;experiment_table&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;csv&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;spiece&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;--test, --help, --without-docker, --udocker&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;--threads [VALUE&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="mf"&gt;1.&lt;/span&gt;&lt;span class="n"&gt;experiment&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;csv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="mf"&gt;2.&lt;/span&gt;&lt;span class="n"&gt;reference&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;human&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;or&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mouse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="nl"&gt;Options&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="c1"&gt;--test test mode(MAX_SPOT_ID=100000).(dafault : False)&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;--udocker&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;--without-docker&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;--threads&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;--help Show usage.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;なお、自前のfastq filesからの実行はv1.1で載せようと思っています。また、出力はscaled TPMを採用。(Soneson, C., Love, M. I. &amp;amp; Robinson, M. D. Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences. F1000Research 4, 1521 (2015).)。&lt;/p&gt;
&lt;h2&gt;pipelineの構成&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;fasterq-dump : シーケンスデータの取得&lt;/li&gt;
&lt;li&gt;fastqc : QC&lt;/li&gt;
&lt;li&gt;trim-galore : トリミング&lt;/li&gt;
&lt;li&gt;salmon : RNA定量&lt;/li&gt;
&lt;li&gt;multiqc : QCログの回収、可視化&lt;/li&gt;
&lt;li&gt;tximport : 遺伝子テーブルの生成&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;となっています。各ツールの説明は省きますが、今時のツールの選定になっていると思います。&lt;/p&gt;
&lt;h2&gt;idep&lt;/h2&gt;
&lt;p&gt;本ツールは&lt;a href="http://bioinformatics.sdstate.edu/idep/"&gt;idep&lt;/a&gt;を意識した設計になっています。idepはRNA-seqの解析をinteractiveに行えるプラットフォームで、Differential expressed genes(DEGs)の検出だけではなく、遺伝子、サンプルのクラスタリング、パスウェイ解析、可視化などが行えます。idepについては以下がとても参考になります。&lt;/p&gt;
&lt;p&gt;&lt;a href="http://kazumaxneo.hatenablog.com/entry/2018/12/29/153838"&gt;macでインフォマティクス : インタラクティブなRNA seq解析webアプリケーション iDEP&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="2" src="/previews/refs/heads/feature/category_pages/blog/2019/03/images/original_rnaseq_pipeline_figs/screenshot-from-2019-03-19-23-14-31.png"&gt;&lt;/p&gt;
&lt;h2&gt;githubを用いたチーム開発&lt;/h2&gt;
&lt;p&gt;今回、githubを用いてチーム開発を行いました。githubはエンジニアの間では当たり前のツールで、チームでのソフト開発によく用いられます。bioinformatics界隈でチーム開発を経験できることは意外に少なく、非常にいい経験になりました。&lt;/p&gt;
&lt;p&gt;&lt;img alt="3" src="/previews/refs/heads/feature/category_pages/blog/2019/03/images/original_rnaseq_pipeline_figs/ikra_git.png"&gt;&lt;/p&gt;
&lt;p&gt;雑多にはなりましたが、阪医Python会bioinformaticsチームの成果をアナウンスさせていただきました。完成までには3ヶ月ほどを要し、各人のアイデアや努力が詰まっております。今後もどんどん開発を進めていこうと思います。また、皆様のissue, Pull Requestもお待ちしております。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Enjoy bioinformatics life!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="4" src="/previews/refs/heads/feature/category_pages/blog/2019/03/images/original_rnaseq_pipeline_figs/ios-e381aee794bbe5838f.jpg"&gt;&lt;/p&gt;</content><category term="Blog"></category><category term="Bioinformatics"></category></entry><entry><title>Bioinformatics春合宿@三島</title><link href="/previews/refs/heads/feature/category_pages/blog/2019/03/mishima.html" rel="alternate"></link><published>2019-03-10T00:00:00+09:00</published><updated>2019-03-10T00:00:00+09:00</updated><author><name>安水</name></author><id>tag:None,2019-03-10:/previews/refs/heads/feature/category_pages/blog/2019/03/mishima.html</id><summary type="html"></summary><content type="html">&lt;p&gt;平岡と安水は2019/03/04-09の一週間、静岡県三島市の国立遺伝学研究所にある&lt;a href="https://dbcls.rois.ac.jp/"&gt;DBCLS&lt;/a&gt;にてbioinformatics合宿をしていました。定量、アセンブリを始めとするトランスクリプトーム解析やjuliaの入門、データベースのコツなど、たくさんのことを学びました。bioinformatics意外にも、坊農さんのグルメツアーや温泉、富士山など、季節ならではの三島を堪能することができました。詳しくは以下の日誌をご覧ください。&lt;/p&gt;
&lt;h3&gt;平岡&lt;/h3&gt;
&lt;p&gt;&lt;a href="https://github.com/yuna06/mishima2019/blob/master/README.md"&gt;mishima2019&lt;/a&gt;
 &lt;/p&gt;
&lt;h3&gt;安水&lt;/h3&gt;
&lt;p&gt;&lt;a href="https://github.com/yyoshiaki/mishima_gassyuku/blob/master/README.md"&gt;三島合宿日誌&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;最後に、合宿を快諾いただいた坊農さんはじめ、仲里さん、内藤さん、小野さん、大田さんには心よりお礼申し上げます。生涯忘れることない、大切な経験になりました。&lt;/p&gt;
&lt;p&gt;&lt;img alt="1" src="/previews/refs/heads/feature/category_pages/blog/2019/03/images/mishima_figs/img_8242.jpg"&gt;&lt;/p&gt;</content><category term="Blog"></category><category term="Bioinformatics"></category></entry><entry><title>Mockinbirdを用いたPAR-CLIP解析</title><link href="/previews/refs/heads/feature/category_pages/blog/2019/01/mockinbird_parclip.html" rel="alternate"></link><published>2019-01-18T00:00:00+09:00</published><updated>2019-01-18T00:00:00+09:00</updated><author><name>平岡</name></author><id>tag:None,2019-01-18:/previews/refs/heads/feature/category_pages/blog/2019/01/mockinbird_parclip.html</id><summary type="html"></summary><content type="html">&lt;p&gt;今回は &lt;strong&gt;PAR-CLIP&lt;/strong&gt; 解析のAll-in-oneパイプラインソフトウェアである、&lt;a href="http://wwwuser.gwdg.de/~compbiol/mockinbird/doc/intro.html"&gt;Mockinbird&lt;/a&gt;を紹介します。日本語での情報がほぼなく、説明が長くなってしまいそうなので、２回に分けて書きます。&lt;/p&gt;
&lt;h2&gt;PAR-CLIPって何？&lt;/h2&gt;
&lt;p&gt;PAR-CLIPは photoactivatable ribonucleoside-enhanced crosslinking and immunoprecipitation の略でRNAやmicroRNA結合タンパクの結合サイトを特定するために使います。&lt;/p&gt;
&lt;p&gt;実験法としては、まず4SU（4-チオウリジン）を細胞培地中に添加し、4SUによるラベル標識を行います。次にUVの照射を行い、RNA結合タンパクとRNAの間で架橋反応を起こします。その後、RBPと結合したリードの抽出を行い、サンプルとして用います。&lt;/p&gt;
&lt;p&gt;サンプルRNAを逆転写するときに、4SUがシトシン( C )に置換されます(misread)。そのため、リードがピークを形成し、かつT -&amp;gt; C置換が入っていた場合、RBPと結合していた可能性が高いということになります。これによりあるタンパクが、RNAのどの領域に結合するのか？結合領域間でどのような相互作用があるのかを知ることができます。特に一塩基という高い解像度での解析ができることが特徴です。&lt;/p&gt;
&lt;p&gt;&lt;img alt="1" src="/previews/refs/heads/feature/category_pages/blog/2019/01/images/mockinbird_parclip_figs/hits-clip-clip-seq-ptb-seq.png"&gt;&lt;/p&gt;
&lt;h2&gt;Mockinbirdとは？&lt;/h2&gt;
&lt;p&gt;&lt;a href="//wwwuser.gwdg.de/~compbiol/mockinbird/doc/intro.html”"&gt;公式ドキュメント&lt;/a&gt;、&lt;a href="//github.com/soedinglab/mockinbird)”"&gt;GitHub&lt;/a&gt;に詳細は記載されていますが、日本語での情報が少ない、というか全くない。のでまとめていきたいと思います。&lt;/p&gt;
&lt;p&gt;PAR-CLIPの解析は生のFASTQデータから、Quality Check -&amp;gt; Trimming -&amp;gt; Mapping -&amp;gt; Downstream Analysisという流れで行いますが、それらすべての解析をMockinbirdでは一気に行ってくれます。また、MockinbirdModule（詳細は後述）を使うことでmock PAR-CLIP experimentを考慮に入れた解析を行うことができるのも大きな特徴です。&lt;/p&gt;
&lt;p&gt;このソフトでは、２つにパイプラインが分かれており、preprocessing phaseとpostprocessing phaseと呼ばれています。タンパク結合サイトの情報が書かれたテーブルを出力するまでが、preprocessing phaseでそれ以降のDownstream解析をpostprocessing phaseと呼んでいます。それぞれにYAMLファイルが用意されており、ユーザーはYAMLファイルで解析したいサンプルデータ、使いたいリファレンスデータ、使いたいモジュール（Mappingの時にSTARやBowtieを選べたりする。）閾値などのパラメータを指定します。最後にコマンドを一行実行するだけで、解析がすべて自動で流れていきます。あるモジュールで出力されたファイルのパスが次のモジュールに自動で設定されていくシステムになっているので、慣れると非常に便利です。&lt;/p&gt;
&lt;p&gt;ただ、ドキュメントでも、既存の解析手法に完全に取って代わるものではなく、PAR-CLIP実験のコンディションのトラブルシューティングを再現可能性が高い状態で行なったり、研究の最初の仮説づくりを短時間で行うために使ってもらうことが目的と書かれていました。&lt;/p&gt;
&lt;p&gt;&lt;img alt="2" src="/previews/refs/heads/feature/category_pages/blog/2019/01/images/mockinbird_parclip_figs/library.png"&gt;&lt;/p&gt;
&lt;h2&gt;環境構築&lt;/h2&gt;
&lt;p&gt;前置きが長くなりましたが、実際に環境構築から進めていきます。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;conda create -n mockinbird -c bioconda -c conda-forge &lt;span class="nv"&gt;python&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.6 mockinbird
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Anacondaでmockinbirdという名前の仮想環境を作ります。mockinbirdが仮想環境にインストールされることになり、これにより、下記のライブラリとツールが環境内で使えるようになります。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;source&lt;/span&gt; activate mockinbird
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;でmockinbirdの仮想環境を立ち上げ、&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;source&lt;/span&gt; deactivate mockinbird
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;で仮想環境を閉じます。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;conda remove --all -n mockinbird
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;で環境を削除します。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git clone https://github.com/soedinglab/mockinbird.git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;でgithubからクローンします。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; mockinbird/mockinbird/data
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;とディレクトリを進めていくと、&lt;code&gt;preprocess.yaml&lt;/code&gt;, &lt;code&gt;postprocess.yaml&lt;/code&gt;というファイルがあります。基本はこの二つのYAMLファイルを調整していくことになります。terminalでコマンドを出すときも &lt;code&gt;mockinbird/mockinbird/data&lt;/code&gt;ディレクトリで実行するのが個人的にはおすすめです（ファイルの構成が綺麗になる。パスの調整も楽）。&lt;/p&gt;
&lt;p&gt;&lt;a href="http://wwwuser.gwdg.de/~compbiol/mockinbird/doc/getting_started.html#tutorial"&gt;Tutorialデータ&lt;/a&gt;がドキュメントの方に書かれていましたが、私が見たときはリンクがNotFoundになっていました。ので、私は&lt;a href="http://wwwuser.gwdg.de/~compbiol/mockinbird/doc/"&gt;公式ドキュメント&lt;/a&gt;や&lt;a href="https://github.com/soedinglab/mockinbird"&gt;GitHub&lt;/a&gt;を参考にYAMLファイルの調整などを行いました。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;preprocess&lt;/code&gt;, &lt;code&gt;postprocess&lt;/code&gt;の実行のコードは以下のようになっています。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# mockinbird preprocess [parclip_fastq] [output_dir] [prefix] [config_file]&lt;/span&gt;
$ mockinbird preprocess nrd1.fastq nrd1 nrd1 preprocess.yaml

&lt;span class="c1"&gt;# mockinbird postprocess {{genomefasta}} {{output_dir}} {{output_dir}} {{script_dir}}&lt;/span&gt;
$ mockinbird postprocess nrd1 nrd1_pp postprocess.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ですが、コードの実行はYAMLの設定ができてからになります。ということでYAMLの中身について説明していきます。&lt;/p&gt;
&lt;h3&gt;preprocess.yaml&lt;/h3&gt;
&lt;p&gt;preprocess.yamlの４つの区画から構成されています。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;① 変数設定。&lt;/li&gt;
&lt;li&gt;② general. 必須情報の設定。&lt;/li&gt;
&lt;li&gt;③ reads. リードについての情報。&lt;/li&gt;
&lt;li&gt;④ pipeline. 使うモジュールと各引数の設定。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;① 変数設定
下記のコードはドキュメントから引用していますが、モジュールで使う、ディレクトリの変数化と、mock_processing をFalseに設定しています。（ここ重要！）&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="p p-Indicator"&gt;{&lt;/span&gt;&lt;span class="err"&gt;%&lt;/span&gt; &lt;span class="nv"&gt;set data_dir = &amp;quot;data&amp;quot; %&lt;/span&gt;&lt;span class="p p-Indicator"&gt;}&lt;/span&gt;

&lt;span class="p p-Indicator"&gt;{&lt;/span&gt;&lt;span class="err"&gt;%&lt;/span&gt; &lt;span class="nv"&gt;set genome_fasta = data_dir + &amp;quot;/genome.fa&amp;quot; %&lt;/span&gt;&lt;span class="p p-Indicator"&gt;}&lt;/span&gt;
&lt;span class="p p-Indicator"&gt;{&lt;/span&gt;&lt;span class="err"&gt;%&lt;/span&gt; &lt;span class="nv"&gt;set mock_pileup = data_dir + &amp;quot;/mock.mpileup&amp;quot; %&lt;/span&gt;&lt;span class="p p-Indicator"&gt;}&lt;/span&gt;
&lt;span class="p p-Indicator"&gt;{&lt;/span&gt;&lt;span class="err"&gt;%&lt;/span&gt; &lt;span class="nv"&gt;set mock_statistics = data_dir + &amp;quot;/mock_stat.json&amp;quot; %&lt;/span&gt;&lt;span class="p p-Indicator"&gt;}&lt;/span&gt;
&lt;span class="p p-Indicator"&gt;{&lt;/span&gt;&lt;span class="err"&gt;%&lt;/span&gt; &lt;span class="nv"&gt;set norm_pileup = data_dir + &amp;quot;/normalization.mpileup&amp;quot; %&lt;/span&gt;&lt;span class="p p-Indicator"&gt;}&lt;/span&gt;
&lt;span class="p p-Indicator"&gt;{&lt;/span&gt;&lt;span class="err"&gt;%&lt;/span&gt; &lt;span class="nv"&gt;set bowtie_index = data_dir + &amp;quot;/bowtie_index/genome&amp;quot; %&lt;/span&gt;&lt;span class="p p-Indicator"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;# setting mock_processing to True will only process the mock. Setting to `False` will run the full&lt;/span&gt;
&lt;span class="c1"&gt;# pipeline&lt;/span&gt;
&lt;span class="p p-Indicator"&gt;{&lt;/span&gt;&lt;span class="err"&gt;%&lt;/span&gt; &lt;span class="nv"&gt;set mock_processing = False %&lt;/span&gt;&lt;span class="p p-Indicator"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;② general. 必須情報の設定
アダプター配列の指定、リファレンスデータの指定、UMI(Unique molecular identifiers)の有無、スレッド数の指定。&lt;/p&gt;
&lt;p&gt;③ reads. リードについての情報
リードの最短長、T -&amp;gt; C mutationの指定&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nt"&gt;general&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;adapter5prime&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;GTTCAGAGTTCTACAGTCCGACGATC&lt;/span&gt;
    &lt;span class="nt"&gt;adapter3prime&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;TGGAATTCTCGGGTGCCAAGG&lt;/span&gt;
    &lt;span class="nt"&gt;genomefasta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;genome_fasta&lt;/span&gt; &lt;span class="p p-Indicator"&gt;}}&lt;/span&gt;
    &lt;span class="nt"&gt;normalization_pileup&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;norm_pileup&lt;/span&gt; &lt;span class="p p-Indicator"&gt;}}&lt;/span&gt;
    &lt;span class="nt"&gt;rmTemp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;yes&lt;/span&gt;
    &lt;span class="nt"&gt;n_threads&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;4&lt;/span&gt;

&lt;span class="nt"&gt;reads&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nt"&gt;bc_5prime&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;5&lt;/span&gt;
    &lt;span class="nt"&gt;bc_3prime&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;0&lt;/span&gt;
    &lt;span class="nt"&gt;min_len&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;20&lt;/span&gt;
    &lt;span class="nt"&gt;reference_nucleotide&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;T&lt;/span&gt;
    &lt;span class="nt"&gt;mutation_nucleotide&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;C&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;④ pipeline. 使うモジュールと各引数の設定
クオリティチェック -&amp;gt; トリミング -&amp;gt; マッピング&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="x"&gt;pipeline:&lt;/span&gt;
&lt;span class="x"&gt;  - FastQCModule:&lt;/span&gt;
&lt;span class="x"&gt;      outdir_name: fastQC_raw&lt;/span&gt;

&lt;span class="x"&gt;  - UmiToolsExtractModule&lt;/span&gt;

&lt;span class="x"&gt;  - SkewerAdapterClippingModule&lt;/span&gt;

&lt;span class="x"&gt;  - ClippyAdapterClippingModule:&lt;/span&gt;
&lt;span class="x"&gt;      clipped_5prime_bc: True&lt;/span&gt;

&lt;span class="x"&gt;  - FastQCModule:&lt;/span&gt;
&lt;span class="x"&gt;      outdir_name: fastQC_clipped&lt;/span&gt;
&lt;span class="x"&gt;      genome_index: &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;bowtie_index&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;

&lt;span class="x"&gt;  - BamPPModule:&lt;/span&gt;
&lt;span class="x"&gt;      remove_n_edge_mut: 2&lt;/span&gt;
&lt;span class="x"&gt;      max_mut_per_read: 1&lt;/span&gt;
&lt;span class="x"&gt;      min_mismatch_quality: 20&lt;/span&gt;

&lt;span class="x"&gt;  - SortIndexModule:&lt;/span&gt;
&lt;span class="x"&gt;     keep_all: yes&lt;/span&gt;

&lt;span class="x"&gt;  - UmiToolsDedupModule&lt;/span&gt;

&lt;span class="x"&gt;  - SortIndexModule:&lt;/span&gt;
&lt;span class="x"&gt;     keep_all: yes&lt;/span&gt;

&lt;span class="x"&gt;  - PileupModule:&lt;/span&gt;
&lt;span class="x"&gt;     keep_all: yes&lt;/span&gt;

&lt;span class="x"&gt;  - BamStatisticsModule&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;MockinbirdModuleを使うことでmock PAR-CLIP experimentを考慮に入れた解析ができますと、すでに書きましたが、Mock Experimentの結果をバックグラウンドとして処理して、PAR-CLIP Experimentの結果を出すことができます。&lt;/p&gt;
&lt;p&gt;具体的な方法としては、まず
&lt;code&gt;mock_processing = True&lt;/code&gt;とし、
&lt;code&gt;mockinbird preprocess nrd1_mock.fastq nrd1_mock nrd1_mock preprocess.yaml&lt;/code&gt;を実行します。これで&lt;code&gt;{% if not mock_processing %}&lt;/code&gt;までで解析がストップします。&lt;/p&gt;
&lt;p&gt;PileupModule, BamStatisticsModuleによって、Mock Experimentの.mpileupファイルと_stat.jsonファイルがそれぞれ生成されます。（この二つのファイルを次に使うことになります。）&lt;/p&gt;
&lt;p&gt;次に&lt;code&gt;mock_processing = False&lt;/code&gt;に戻し、
&lt;code&gt;$ mockinbird preprocess nrd1.fastq nrd1 nrd1 preprocess.yaml&lt;/code&gt;を実行します。すると下記のコードも一緒に実行されます。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="k"&gt;not&lt;/span&gt; &lt;span class="nv"&gt;mock_processing&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;

&lt;span class="x"&gt;    - PredictionSitesModule:&lt;/span&gt;
&lt;span class="x"&gt;        sites_file: &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;data_dir&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;/genome.sites&lt;/span&gt;
&lt;span class="x"&gt;        fasta_file: &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;genome_fasta&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;        transition_nucleotide: T&lt;/span&gt;

&lt;span class="x"&gt;    - MockTableModule:&lt;/span&gt;
&lt;span class="x"&gt;        mock_table: &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;data_dir&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;/mock.table&lt;/span&gt;
&lt;span class="x"&gt;        mock_pileup: &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;mock_pileup&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;

&lt;span class="x"&gt;    - TransitionTableModule&lt;/span&gt;

&lt;span class="x"&gt;    - LearnMockModule:&lt;/span&gt;
&lt;span class="x"&gt;        mock_model: mock_model/model.pkl&lt;/span&gt;
&lt;span class="x"&gt;        mock_statistics: &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;mock_statistics&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;        n_mixture_components: 5&lt;/span&gt;
&lt;span class="x"&gt;        em_iterations: 250&lt;/span&gt;

&lt;span class="x"&gt;    - MockinbirdModule&lt;/span&gt;

&lt;span class="x"&gt;    - NormalizationModule&lt;/span&gt;
&lt;span class="x"&gt;    - QuantileCapModule&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endif&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;これによって、Mock Experimentの&lt;code&gt;.mpileupファイル&lt;/code&gt;と&lt;code&gt;_stat.jsonファイル&lt;/code&gt;を受け取りつつ、最終的なCLIP-seqのテーブルを作ることができ、preprocessは終了となります。下記のようなテーブルが出力され、これをもとにpostprocessに進んでいくことになります。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;seqid   position        transitions     coverage        score   strand  occupancy       posterior&lt;/span&gt;
&lt;span class="err"&gt;chrI    32601   4       4       6.352710158543762       -       0.15384615384615385     0.772109761967&lt;/span&gt;
&lt;span class="err"&gt;chrI    35562   4       5       5.292152965717071       +       0.0223463687150838      0.539841709238&lt;/span&gt;
&lt;span class="err"&gt;chrI    35805   5       5       9.376254703871467       +       0.03184713375796178     0.98585024515&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;長くなってしまったので、モジュールとpostprocessの説明は次回に回したいと思います。長い間お付き合いいただきありがとうございました。&lt;/p&gt;</content><category term="Blog"></category><category term="Bioinformatics"></category></entry><entry><title>Common Workflow Language入門</title><link href="/previews/refs/heads/feature/category_pages/blog/2018/12/cwl.html" rel="alternate"></link><published>2018-12-07T00:00:00+09:00</published><updated>2018-12-07T00:00:00+09:00</updated><author><name>安水</name></author><id>tag:None,2018-12-07:/previews/refs/heads/feature/category_pages/blog/2018/12/cwl.html</id><summary type="html"></summary><content type="html">&lt;p&gt;先日&lt;a href="https://github.com/manabuishii/workflow-meetup/wiki/20181126"&gt;workflow-meetup&lt;/a&gt;にお誘いを頂いて参加してきました。そこでThe Common Workflow Language(CWL)というものを習ったので忘れないうちに&lt;strong&gt;医学部生にもわかりやすく&lt;/strong&gt;まとめます。&lt;/p&gt;
&lt;h2&gt;CWLって？&lt;/h2&gt;
&lt;p&gt;&lt;img alt="cwl" src="https://github.com/common-workflow-language/cwl-website/blob/master/site/CWL-Logo-Header.png?raw=true"&gt;&lt;/p&gt;
&lt;p&gt;一言で言うと、bioinformatics処理の自動化です。どういうことかもうちょっと詳しく見てみましょう。&lt;/p&gt;
&lt;p&gt;&amp;gt;ソフトウェアを組み合わせて構成される一連の作業手順 (ワークフロー) を記述するための仕組みや言語、GUI ソフトウェアは既に多く存在します。しかし、それらは特定の実行環境 (ハードウェア、ソフトウェア) に依存したものであり、異なる環境の間でワークフローを共有、再実行することは困難です。この問題を解決するために、異なるワークフロー実行ソフトウェア (実行エンジン) の間で共通してインポート/エクスポートできるフォーマットを目指して、Common Workflow Language (CWL) の開発が始まりました。&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/pitagora-galaxy/cwl/wiki/CWL-Start-Guide-JP"&gt;素晴らしい日本語ドキュメント&lt;/a&gt;から取ってきました。要はbioinformaticsなど、複数のソフトの連携が必要な処理を自動化、共有がスムーズになるような仕組みです。ローカルでテストして、サーバーやクラウドに持っていくのも簡単です。最近はSangerやBroad Institute(ハーバードとMITの共同研究施設)などでも使われているとのことです。&lt;/p&gt;
&lt;p&gt;まずは&lt;strong&gt;&lt;a href="https://www.youtube.com/embed/86eY8xs-Vo8?cc_load_policy=1&amp;amp;cc_lang_pref=ja&amp;amp;autoplay=1"&gt;60秒でわかるCWL - youtube&lt;/a&gt;&lt;/strong&gt;をみてください。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;.cwl&lt;/code&gt;で記述できるのはtoolとworkflowの二種類です。toolは例えばSTARやkallistoなど一つのツールを一つのcwlファイルに記述します。workflowはそれらのtoolをbindして実際のworkflowにします。更に、workflowをnestして新しいworkflowを作ったりも出来ます。&lt;/p&gt;
&lt;h2&gt;始め方&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="https://github.com/pitagora-galaxy/cwl/wiki/CWL-Start-Guide-JP"&gt;素晴らしい日本語ドキュメント&lt;/a&gt;を読みましょう。10分もあれば読めると思います。&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.google.com/presentation/d/13K6BKQoimiaOIFSnComw8in3HlCxEm820OASP8_jnDI/edit?usp=sharing"&gt;cwl-intro-gui-workshop スライド&lt;/a&gt;をやってみましょう。1時間ほどです。&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.commonwl.org/user_guide/"&gt;user guide&lt;/a&gt;をやりましょう。3時間ほどで終わるように設計されています。(理論値)&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;CWLのここがすごい&lt;/h2&gt;
&lt;p&gt;入門は各サイトにお任せするとして、今回は私がCWLをさわってみてすごいと思ったところをまとめてみます。素人目線です。&lt;/p&gt;
&lt;h3&gt;rabix composerのGUIがきれいすぎる&lt;/h3&gt;
&lt;p&gt;&lt;img alt="rabix gif" src="https://github.com/rabix/composer/raw/master/doc/images/workflows.gif"&gt;&lt;/p&gt;
&lt;p&gt;画像はbioinformaticsでお馴染みのSTARをrabix composerで操っているところです。&lt;a href="http://rabix.io/"&gt;rabix composer&lt;/a&gt;を使えば、GUIで直感的にCWLが触れます。更に出来たworkflowをクラウドやサーバーにそのまま持っていってCLI越しに使うことが出来ます。&lt;/p&gt;
&lt;h3&gt;dockerをベースにして完全にreproducibleにできる&lt;/h3&gt;
&lt;p&gt;いかにも今どきなのですが、toolの記述はすべてdockerのコンテナを使って記述することが出来ます。つまり、環境が変わってインストールし直す手間がまったく無いということです。すばらしいですね。さらに&lt;code&gt;--user-space-docker-cmd=udocker&lt;/code&gt;というオプション一つで、udockerというUser権限しか無い環境でも使えるdockerを使って動かすことができるようです。&lt;/p&gt;
&lt;h3&gt;すでにいろいろなソフトのcwlが出来ている&lt;/h3&gt;
&lt;p&gt;Communityで管理されている&lt;a href="https://github.com/common-workflow-language/workflows"&gt;CWL Tools &amp;amp; Workflows&lt;/a&gt;があります。ほかにもDBCLS太田さんの管理されている&lt;a href="https://github.com/pitagora-galaxy/cwl"&gt;Pitagora Workflows in CWL&lt;/a&gt;もいろいろ揃っています。&lt;/p&gt;
&lt;h3&gt;cwltoolの安定感がすごい&lt;/h3&gt;
&lt;p&gt;出来たcwlファイルをCLI環境で使うにはcwltoolを使います。感動したのはヘルプが自動で生成されるところ。しかも、pythonで書かれていてpythonに組み込むことも出来ます。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;cwltool.factory&lt;/span&gt;
&lt;span class="n"&gt;fac&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cwltool&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;factory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Factory&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fac&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;make&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;echo.cwl&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;echo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;foo&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# result[&amp;quot;out&amp;quot;] == &amp;quot;foo&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;日本人contributerが多い&lt;/h3&gt;
&lt;p&gt;困ったときに助けてくれるやさしいcontributerの方々が日本に何人かいます。また、日本語ドキュメントも多くてとても助かります。更に、開発者の&lt;a href="https://twitter.com/biocrusoe"&gt;Michael R. Crusoe&lt;/a&gt;は来日しており、&lt;a href="https://twitter.com/hashtag/CommonWLjp?src=hash"&gt;#CommonWLjp&lt;/a&gt;などでCWLの輪を広げています。&lt;/p&gt;
&lt;blockquote class="twitter-tweet" data-lang="ja"&gt;&lt;p lang="en" dir="ltr"&gt;On my way to the 11th &lt;a href="https://twitter.com/NBDC_info?ref_src=twsrc%5Etfw"&gt;@NBDC_info&lt;/a&gt; / &lt;a href="https://twitter.com/dbcls?ref_src=twsrc%5Etfw"&gt;@dbcls&lt;/a&gt; &lt;a href="https://twitter.com/hashtag/biohack18?src=hash&amp;amp;ref_src=twsrc%5Etfw"&gt;#biohack18&lt;/a&gt; (with a week long stop in Tokyo for &lt;a href="https://twitter.com/hashtag/usegalaxyjp?src=hash&amp;amp;ref_src=twsrc%5Etfw"&gt;#usegalaxyjp&lt;/a&gt; meeting and other &lt;a href="https://twitter.com/hashtag/CommonWL?src=hash&amp;amp;ref_src=twsrc%5Etfw"&gt;#CommonWL&lt;/a&gt; presentations and a bilingual workshop) &lt;a href="https://t.co/W4gsO9bnA1"&gt;pic.twitter.com/W4gsO9bnA1&lt;/a&gt;&lt;/p&gt;&amp;mdash; Michael R. Crusoe (@biocrusoe) &lt;a href="https://twitter.com/biocrusoe/status/1069104245100748801?ref_src=twsrc%5Etfw"&gt;2018年12月2日&lt;/a&gt;&lt;/blockquote&gt;

&lt;h2&gt;kallistoをCWL + Rabix Composerで試してみる&lt;/h2&gt;
&lt;p&gt;まずは実際の作業工程を見てみましょう。&lt;/p&gt;
&lt;p&gt;&lt;img alt="gif" src="https://github.com/yyoshiaki/cwl_user_guide/blob/master/kallisto/kallisto.gif?raw=true"&gt;&lt;/p&gt;
&lt;p&gt;ちゃんとkallistoのoutputが生成されていますね！データは&lt;a href="https://github.com/yyoshiaki/cwl_user_guide/tree/master/kallisto"&gt;github&lt;/a&gt;にまとめておきました。テスト用のシーケンスデータも付けてあるので、クローンして遊んでみてください。&lt;code&gt;kallisto-index.cwl&lt;/code&gt;と&lt;code&gt;kallisto-quant.cwl&lt;/code&gt;は公式の&lt;a href="https://github.com/common-workflow-language/workflows"&gt;CWL Tools &amp;amp; Workflows&lt;/a&gt;から取ってきました。もちろんこれらはdocker imageを使っています。新しいworkflowを作ってみましょう。動画のように直感的にできると思います。&lt;/p&gt;
&lt;p&gt;今回、errorが出て進まなかった場所があったのですが、石井さん、西田さんの応援や、cwlの作者のMichaelやRabixの作者のKaushikがerrorに対処してくれました。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href="https://github.com/rabix/composer/issues/418#issuecomment-444257454"&gt;issue : kallisto workflow is incompatible with Rabix composer #418&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;この対応のフレンドリーさはbioinformaticsならではですね。&lt;/p&gt;
&lt;h2&gt;workflow業界のあれこれ&lt;/h2&gt;
&lt;p&gt;ここで一旦workflowについて広く見てみましょう。ハーバードを始めとする海外の研究所ではサーバーを研究所ごとに管理するのに変えて、クラウドの利用が盛んになってきています。そういう時代感もあり、workflowやコンテナなど、reproducibleな環境の整備というのはますます重要視されてきています。workflow業界ではcwlの他に古き良き&lt;a href="http://wiki.pitagora-galaxy.org/wiki/index.php/Workflows"&gt;Galaxy&lt;/a&gt;、Broad Instituteが開発している&lt;a href="https://software.broadinstitute.org/wdl/"&gt;WDL&lt;/a&gt;や&lt;a href="https://www.nextflow.io/"&gt;nextflow&lt;/a&gt;、Pythonで書かれている&lt;a href="https://snakemake.readthedocs.io/en/stable/"&gt;Snakemake&lt;/a&gt;など、さまざまな選択肢があります。どのworkflowが好きか、Cambridgeの&lt;a href="https://twitter.com/@AlbertVilella"&gt;@AlbertVilella&lt;/a&gt;が世界中のbioinformaticianにアンケートをとっていました。&lt;/p&gt;
&lt;blockquote class="twitter-tweet" data-lang="ja"&gt;&lt;p lang="en" dir="ltr"&gt;90 responses in &lt;a href="https://t.co/hbaY7ShocR"&gt;https://t.co/hbaY7ShocR&lt;/a&gt; &lt;a href="https://twitter.com/nextflowio?ref_src=twsrc%5Etfw"&gt;@nextflowio&lt;/a&gt; &lt;a href="https://twitter.com/SBGenomics?ref_src=twsrc%5Etfw"&gt;@SBGenomics&lt;/a&gt; &lt;a href="https://twitter.com/commonwl?ref_src=twsrc%5Etfw"&gt;@commonwl&lt;/a&gt; Snamemake &lt;a href="https://t.co/1kc1DaXdBa"&gt;pic.twitter.com/1kc1DaXdBa&lt;/a&gt;&lt;/p&gt;&amp;mdash; Albert Vilella (@AlbertVilella) &lt;a href="https://twitter.com/AlbertVilella/status/1070219898306084865?ref_src=twsrc%5Etfw"&gt;2018年12月5日&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class="twitter-tweet" data-lang="ja"&gt;&lt;p lang="en" dir="ltr"&gt;No votes so far for &lt;a href="https://twitter.com/ensembl?ref_src=twsrc%5Etfw"&gt;@ensembl&lt;/a&gt; Hive, Apache Taverna or &lt;a href="https://twitter.com/arvados?ref_src=twsrc%5Etfw"&gt;@arvados&lt;/a&gt; , even though we know they have plenty of users &lt;a href="https://t.co/Db2el8vPDt"&gt;https://t.co/Db2el8vPDt&lt;/a&gt; &lt;a href="https://twitter.com/hashtag/Bioinformatics?src=hash&amp;amp;ref_src=twsrc%5Etfw"&gt;#Bioinformatics&lt;/a&gt; &lt;a href="https://twitter.com/hashtag/Workflows?src=hash&amp;amp;ref_src=twsrc%5Etfw"&gt;#Workflows&lt;/a&gt; &lt;a href="https://t.co/hbaY7ShocR"&gt;https://t.co/hbaY7ShocR&lt;/a&gt;&lt;/p&gt;&amp;mdash; Albert Vilella (@AlbertVilella) &lt;a href="https://twitter.com/AlbertVilella/status/1070579264192462849?ref_src=twsrc%5Etfw"&gt;2018年12月6日&lt;/a&gt;&lt;/blockquote&gt;

&lt;p&gt;どうやら一番twitter界隈のbioinformaticianはnextflowが好きなようです。ただ、下のspreadsheetを見ると、githubではGalaxy,bcbioについで三番目に盛んなようです。&lt;/p&gt;
&lt;p&gt;他にも、cwlやnextflowを取り上げたgenome解析の論文も出ていたりします。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-018-2446-1"&gt;Baichoo, S. et al. Developing reproducible bioinformatics analysis workflows for heterogeneous computing environments to support African genomics. BMC Bioinformatics 19, 457 (2018).&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;結論　みんなでCWLを使おう！&lt;/h2&gt;
&lt;p&gt;医学部生にできるだけわかりやすく書いてみました。みんなでcwlを使ってどんどん解析を楽にしましょう！&lt;/p&gt;
&lt;p&gt;国試も自動化できたらなあ。。。&lt;/p&gt;
&lt;h2&gt;参考資料&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.commonwl.org/"&gt;CWL公式ページ&lt;/a&gt; : リンク集がついている。&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.google.com/presentation/d/13K6BKQoimiaOIFSnComw8in3HlCxEm820OASP8_jnDI/edit?usp=sharing"&gt;cwl-intro-gui-workshop スライド&lt;/a&gt; : 二階堂研石井さんのスライド。わかりやすいです。&lt;/li&gt;
&lt;/ul&gt;</content><category term="Blog"></category><category term="Bioinformatics"></category></entry><entry><title>Gene Set Enrichment Analysis (GSEA)入門</title><link href="/previews/refs/heads/feature/category_pages/blog/2018/11/gsea.html" rel="alternate"></link><published>2018-11-27T00:00:00+09:00</published><updated>2018-11-27T00:00:00+09:00</updated><author><name>西田</name></author><id>tag:None,2018-11-27:/previews/refs/heads/feature/category_pages/blog/2018/11/gsea.html</id><summary type="html"></summary><content type="html">&lt;h2&gt;GSEAとは&lt;/h2&gt;
&lt;p&gt;GSEAは発現差異解析の結果などで得られる遺伝子群がどういった機能のものかを明らかにするために用いられる解析手法です。機能表現として用いられる主なものとしてはKEGGのパスウェイ分類やGene Ontology(GO)があります。&lt;/p&gt;
&lt;h2&gt;clusterProfilerでGSEA入門&lt;/h2&gt;
&lt;p&gt;GSEA には様々なGSEAがあります。単に注目する遺伝子のリストをGSEAへの入力とするもの、発現プロファイルを入力とするもの、機能のデータベースやGSEA手法を複数組み合わせたりするもの (EGSEA) など様々です。[余談ですがGeneを代謝物(Metabolite)に置き換えたMSEAもあります。]&lt;/p&gt;
&lt;p&gt;ここでは前述したものの内、最初の「単に注目する遺伝子のリストをGSEAへの入力とするもの」をbioconductorのパッケージ clusterProfiler を用いて体験してみましょう。&lt;/p&gt;
&lt;p&gt;(clusterProfilerのインストールについては省略します。)&lt;/p&gt;
&lt;p&gt;まず注目する遺伝子のリストを下記で用意します。&lt;/p&gt;
&lt;p&gt;※編集注 : 以下はすべてRでの実行になります。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;geneList&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;package&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;DOSE&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;gene&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;geneList&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="nf"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;geneList&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;gene&lt;/span&gt;
  &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;4312&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;8318&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;10874&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;55143&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;55388&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;991&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;6280&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;2305&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9493&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1062&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3868&amp;quot;&lt;/span&gt;  
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;12&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;4605&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9833&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9133&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;6279&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;10403&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;8685&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;597&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;7153&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;23397&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;6278&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;79733&amp;quot;&lt;/span&gt;
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;259266&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1381&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3627&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;27074&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;6241&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;55165&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;9787&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;7368&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;11065&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;55355&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;9582&amp;quot;&lt;/span&gt;  
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;34&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;220134&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;55872&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;51203&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;3669&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;83461&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;22974&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;10460&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;10563&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4751&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;6373&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;8140&amp;quot;&lt;/span&gt;  
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;45&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;79019&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;820&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;10635&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;1844&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;4283&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;27299&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;55839&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;27338&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;890&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;9415&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;983&amp;quot;&lt;/span&gt;   
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;56&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;54821&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;10232&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4085&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;6362&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9837&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;5080&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;7850&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;81930&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;5918&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;81620&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;332&amp;quot;&lt;/span&gt;   
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;67&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;55765&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;79605&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;3832&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;6286&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;5163&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;2146&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3002&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;50852&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;7272&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;2568&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;64151&amp;quot;&lt;/span&gt;
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;78&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;51806&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;366&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;2842&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9212&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;140578&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;51659&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;8715&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;4902&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;8208&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1111&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9319&amp;quot;&lt;/span&gt;  
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;89&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;9055&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3833&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;146909&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;23475&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4321&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;11182&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;10112&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;3902&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3620&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3887&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;51514&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;6790&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;4521&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;891&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;57110&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;8544&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1448&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;24137&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;6355&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;10578&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4174&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9232&amp;quot;&lt;/span&gt;  
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;111&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;643314&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1307&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;776&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;4129&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9370&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;196740&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;25924&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;8857&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1602&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;51161&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;3708&amp;quot;&lt;/span&gt;  
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;122&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;23090&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;10742&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;51760&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;9122&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;10699&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;8416&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;60598&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;79148&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;64799&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4629&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1556&amp;quot;&lt;/span&gt;  
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;133&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;55096&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;26289&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;6038&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;771&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;51313&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;23704&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;3117&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;80129&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;23158&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;125&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;4958&amp;quot;&lt;/span&gt;  
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;144&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;4857&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1311&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;5105&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;5174&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;730&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;2018&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;81563&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;2532&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1308&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;4250&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;23362&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;155&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;2167&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;51705&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;2593&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;652&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;80736&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4036&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;57502&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;5507&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;56521&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;22885&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4137&amp;quot;&lt;/span&gt;  
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;166&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;8483&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;8839&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;2066&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;4693&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;4148&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;79083&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;1101&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3158&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3169&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;5346&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1408&amp;quot;&lt;/span&gt;  
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;177&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;9547&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;2922&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;11283&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;64499&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;54829&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;1524&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;10234&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;1580&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;10647&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;25893&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;24141&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;188&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;10351&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;2330&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;5304&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;79846&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;8614&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;2625&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;7021&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;7802&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;79689&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;11122&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;55351&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;199&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;9&amp;quot;&lt;/span&gt;      &lt;span class="s"&gt;&amp;quot;4239&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;5241&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;10551&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;10974&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;79838&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;79901&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;57758&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4969&amp;quot;&lt;/span&gt;  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;gene&lt;/code&gt;はヒト遺伝子のENTREZのIDです。&lt;/p&gt;
&lt;p&gt;この遺伝子リストを入力としてKEGGを対象としたGSEAを行ってみましょう。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nf"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clusterProfiler&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;kk&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;enrichKEGG&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gene&lt;/span&gt;         &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gene&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;+&lt;/span&gt;                  &lt;span class="n"&gt;organism&lt;/span&gt;     &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;hsa&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;+&lt;/span&gt;                  &lt;span class="n"&gt;pvalueCutoff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0.05&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kk&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
               &lt;span class="n"&gt;ID&lt;/span&gt;                             &lt;span class="n"&gt;Description&lt;/span&gt; &lt;span class="n"&gt;GeneRatio&lt;/span&gt;  &lt;span class="n"&gt;BgRatio&lt;/span&gt;       &lt;span class="n"&gt;pvalue&lt;/span&gt;     &lt;span class="n"&gt;p.adjust&lt;/span&gt;       &lt;span class="n"&gt;qvalue&lt;/span&gt;                                             &lt;span class="n"&gt;geneID&lt;/span&gt; &lt;span class="n"&gt;Count&lt;/span&gt;
&lt;span class="n"&gt;hsa04110&lt;/span&gt; &lt;span class="n"&gt;hsa04110&lt;/span&gt;                              &lt;span class="n"&gt;Cell&lt;/span&gt; &lt;span class="n"&gt;cycle&lt;/span&gt;     &lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;90&lt;/span&gt; &lt;span class="m"&gt;123&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;7469&lt;/span&gt; &lt;span class="m"&gt;2.135411e-07&lt;/span&gt; &lt;span class="m"&gt;0.0000409999&lt;/span&gt; &lt;span class="m"&gt;4.023565e-05&lt;/span&gt; &lt;span class="m"&gt;8318&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;991&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;9133&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;890&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;983&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;4085&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;7272&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;1111&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;891&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;4174&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;9232&lt;/span&gt;    &lt;span class="m"&gt;11&lt;/span&gt;
&lt;span class="n"&gt;hsa04114&lt;/span&gt; &lt;span class="n"&gt;hsa04114&lt;/span&gt;                          &lt;span class="n"&gt;Oocyte&lt;/span&gt; &lt;span class="n"&gt;meiosis&lt;/span&gt;     &lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;90&lt;/span&gt; &lt;span class="m"&gt;125&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;7469&lt;/span&gt; &lt;span class="m"&gt;2.216832e-06&lt;/span&gt; &lt;span class="m"&gt;0.0002128158&lt;/span&gt; &lt;span class="m"&gt;2.088489e-04&lt;/span&gt;    &lt;span class="m"&gt;991&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;9133&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;983&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;4085&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;51806&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;6790&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;891&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;9232&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;3708&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;5241&lt;/span&gt;    &lt;span class="m"&gt;10&lt;/span&gt;
&lt;span class="n"&gt;hsa04218&lt;/span&gt; &lt;span class="n"&gt;hsa04218&lt;/span&gt;                     &lt;span class="n"&gt;Cellular&lt;/span&gt; &lt;span class="n"&gt;senescence&lt;/span&gt;     &lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;90&lt;/span&gt; &lt;span class="m"&gt;160&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;7469&lt;/span&gt; &lt;span class="m"&gt;2.014286e-05&lt;/span&gt; &lt;span class="m"&gt;0.0012891427&lt;/span&gt; &lt;span class="m"&gt;1.265113e-03&lt;/span&gt;     &lt;span class="m"&gt;2305&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;4605&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;9133&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;890&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;983&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;51806&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;1111&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;891&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;776&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;3708&lt;/span&gt;    &lt;span class="m"&gt;10&lt;/span&gt;
&lt;span class="n"&gt;hsa03320&lt;/span&gt; &lt;span class="n"&gt;hsa03320&lt;/span&gt;                  &lt;span class="n"&gt;PPAR&lt;/span&gt; &lt;span class="n"&gt;signaling&lt;/span&gt; &lt;span class="n"&gt;pathway&lt;/span&gt;      &lt;span class="m"&gt;7&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;90&lt;/span&gt;  &lt;span class="m"&gt;74&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;7469&lt;/span&gt; &lt;span class="m"&gt;2.724093e-05&lt;/span&gt; &lt;span class="m"&gt;0.0013075646&lt;/span&gt; &lt;span class="m"&gt;1.283191e-03&lt;/span&gt;                 &lt;span class="m"&gt;4312&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;9415&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;9370&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;5105&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;2167&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;3158&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;5346&lt;/span&gt;     &lt;span class="m"&gt;7&lt;/span&gt;
&lt;span class="n"&gt;hsa04914&lt;/span&gt; &lt;span class="n"&gt;hsa04914&lt;/span&gt; &lt;span class="n"&gt;Progesterone&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;mediated&lt;/span&gt; &lt;span class="n"&gt;oocyte&lt;/span&gt; &lt;span class="n"&gt;maturation&lt;/span&gt;      &lt;span class="m"&gt;7&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;90&lt;/span&gt;  &lt;span class="m"&gt;98&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;7469&lt;/span&gt; &lt;span class="m"&gt;1.657604e-04&lt;/span&gt; &lt;span class="m"&gt;0.0063651988&lt;/span&gt; &lt;span class="m"&gt;6.246549e-03&lt;/span&gt;                    &lt;span class="m"&gt;9133&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;890&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;983&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;4085&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;6790&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;891&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;5241&lt;/span&gt;     &lt;span class="m"&gt;7&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;kk&lt;/code&gt; がGSEAの結果になります。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;head(kk)&lt;/code&gt; でGSEAの結果を上から確からしいもの順にトップ5を出力しています。&lt;/p&gt;
&lt;p&gt;もし遺伝子リスト&lt;code&gt;gene&lt;/code&gt;が発現差異解析の結果であるなら、コントロールとターゲット間で&lt;code&gt;Cell cycle&lt;/code&gt;等に異変が起きているだろう、とこの結果から推測できるということになります。&lt;/p&gt;
&lt;p&gt;次に&lt;code&gt;kk&lt;/code&gt;の各列名の意味ですが&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IDはKEGG pathwayのID&lt;/li&gt;
&lt;li&gt;DescriptionはKEGG pathwayの名前&lt;/li&gt;
&lt;li&gt;GeneRatioは入力&lt;code&gt;gene&lt;/code&gt;の遺伝子の内、何個の遺伝子がそのKEGG pathwayにマップされるか&lt;/li&gt;
&lt;li&gt;BgRatioは全KEGG pathwayにマップされる遺伝子の内、何個の遺伝子がそのKEGG pathwayにマップされるか&lt;/li&gt;
&lt;li&gt;p.adjust, qvalueは多重検定に伴う補正後のpvalueになり小さいほど確からしいことを示します。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;入力&lt;code&gt;gene&lt;/code&gt;に含まれる遺伝子がKEGG pathway上のどのgene productにmapされるかを可視化するには下記を実行します。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;browseKEGG(kk, &amp;#39;hsa04110&amp;#39;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="KEGG map" src="/previews/refs/heads/feature/category_pages/blog/2018/11/images/gsea_figs/null9.png"&gt;&lt;/p&gt;
&lt;h2&gt;終わりに&lt;/h2&gt;
&lt;p&gt;最も簡単なGSEAを体験していただく例を示しました。&lt;/p&gt;
&lt;p&gt;追ってより進んだアンサンブル手法なども紹介できればと思っています。&lt;/p&gt;</content><category term="Blog"></category><category term="Bioinformatics"></category></entry><entry><title>化合物データ処理ソフト RDKit</title><link href="/previews/refs/heads/feature/category_pages/blog/2018/11/RDKit.html" rel="alternate"></link><published>2018-11-21T23:00:00+09:00</published><updated>2018-11-21T23:00:00+09:00</updated><author><name>川島</name></author><id>tag:None,2018-11-21:/previews/refs/heads/feature/category_pages/blog/2018/11/RDKit.html</id><summary type="html"></summary><content type="html">&lt;style type="text/css"&gt;/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell &gt; div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area &gt; div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area &gt; div.highlight &gt; pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the &lt;head&gt; if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev &lt;Maniac@SoftwareManiacs.Org&gt;
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph &gt; img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell &gt; div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
&lt;/style&gt;
&lt;style type="text/css"&gt;.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */&lt;/style&gt;&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;&lt;strong&gt;RDkit&lt;/strong&gt;は化合物(低分子有機化合物)を扱うためのpythonパッケージです。&lt;strong&gt;ケモインフォマティクス(Cheminformatics)&lt;/strong&gt; という創薬系の分野でよく用いられています。今回はこれの簡単な使い方を説明します。&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="&amp;#12356;&amp;#12388;&amp;#12418;&amp;#12398;&amp;#12497;&amp;#12483;&amp;#12465;&amp;#12540;&amp;#12472;&amp;#12398;&amp;#12452;&amp;#12531;&amp;#12509;&amp;#12540;&amp;#12488;"&gt;&amp;#12356;&amp;#12388;&amp;#12418;&amp;#12398;&amp;#12497;&amp;#12483;&amp;#12465;&amp;#12540;&amp;#12472;&amp;#12398;&amp;#12452;&amp;#12531;&amp;#12509;&amp;#12540;&amp;#12488;&lt;a class="anchor-link" href="#&amp;#12356;&amp;#12388;&amp;#12418;&amp;#12398;&amp;#12497;&amp;#12483;&amp;#12465;&amp;#12540;&amp;#12472;&amp;#12398;&amp;#12452;&amp;#12531;&amp;#12509;&amp;#12540;&amp;#12488;"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;span class="c1"&gt;# coding:utf-8&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="RDKit&amp;#12398;&amp;#12452;&amp;#12531;&amp;#12473;&amp;#12488;&amp;#12540;&amp;#12523;&amp;#12392;&amp;#12452;&amp;#12531;&amp;#12509;&amp;#12540;&amp;#12488;"&gt;RDKit&amp;#12398;&amp;#12452;&amp;#12531;&amp;#12473;&amp;#12488;&amp;#12540;&amp;#12523;&amp;#12392;&amp;#12452;&amp;#12531;&amp;#12509;&amp;#12540;&amp;#12488;&lt;a class="anchor-link" href="#RDKit&amp;#12398;&amp;#12452;&amp;#12531;&amp;#12473;&amp;#12488;&amp;#12540;&amp;#12523;&amp;#12392;&amp;#12452;&amp;#12531;&amp;#12509;&amp;#12540;&amp;#12488;"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;miniconda環境かAnaconda環境を入れた後、&lt;code&gt;conda install rdkit&lt;/code&gt;でインストールできると思います。&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rdkit&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rdkit.Chem.Draw&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;IPythonConsole&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stderr output_text"&gt;
&lt;pre&gt;RDKit WARNING: [04:09:51] Enabling RDKit 2019.09.3 jupyter extensions
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;これで、RDKitのインポートは完了です&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="SMILES&amp;#35352;&amp;#27861;"&gt;SMILES&amp;#35352;&amp;#27861;&lt;a class="anchor-link" href="#SMILES&amp;#35352;&amp;#27861;"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;有機化合物の構造をグラフ構造を元に線形表現したものがSMILES記法です。これによって、文字列データのみで分子を表現することが可能になりました。
詳しい書き方は &lt;a href="http://opensmiles.org/opensmiles.html"&gt;http://opensmiles.org/opensmiles.html&lt;/a&gt; で厳密に定義されているので参考にすると良いと思います。&lt;/p&gt;
&lt;p&gt;ただ、自分で書くのはしんどいので、wikipediaの該当化合物のページの横に書いてあるやつ(英語版の方が書いてる確率が高い)を使ったり、SMILESを出力するためのソフトウェアなどを使います。&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;benzene&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;c1ccccc1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;benzene&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[3]:&lt;/div&gt;




&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;tnt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Cc1c2cc3cc14.[N+]2(=O)[O-].[N+]3(=O)[O-].[N+]4(=O)[O-]&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;tnt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[4]:&lt;/div&gt;




&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;pna&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;[H]OO[N+](=O)[O-]&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pna&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[5]:&lt;/div&gt;




&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;warfarin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;CC(=O)CC(C1=C(/O)c2ccccc2OC1=O)c3ccccc3&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;warfarin&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[6]:&lt;/div&gt;




&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;taxol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;CC1=C2C(C(=O)C3(C(CC4C(C3C(C(C2(C)C)(CC1O)O)OC(=O)C5=CC=CC=C5)(CO4)OC(=O)C)O)C)O&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;taxol&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[7]:&lt;/div&gt;




&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;他にもケモインフォ用の機能がたくさんありますが、今回はこの辺で。
よいケモインフォライフを！&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
 


&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;
</content><category term="Blog"></category><category term="Bioinformatics"></category></entry><entry><title>MACS2とdeepToolsのbigwigファイルの比較</title><link href="/previews/refs/heads/feature/category_pages/blog/2018/10/macs2_deeptools.html" rel="alternate"></link><published>2018-10-29T00:00:00+09:00</published><updated>2018-10-29T00:00:00+09:00</updated><author><name>安水</name></author><id>tag:None,2018-10-29:/previews/refs/heads/feature/category_pages/blog/2018/10/macs2_deeptools.html</id><summary type="html"></summary><content type="html">&lt;h2&gt;ChIP-seqとは&lt;/h2&gt;
&lt;p&gt;全身で37兆個あるといわれているヒトの細胞は、基本的にすべて同じDNA配列を有している。しかし、肝細胞、網膜、免疫細胞と細胞にはそれぞれの"個性"がある。更には正常の免疫細胞と暴走している免疫細胞など細胞には"状態"もある。これらを制御する大きな要素としてエピジェネティクスが挙げられ、DNAメチル化やクロマチン修飾などが知られている。ChIP-seq (chromatin immunoprecipitation sequence) は特異的クロマチン修飾を受けている領域を、抗体を用いて沈降、濃縮させ、どの細胞のどの領域でどういう修飾を受けているのかを調べるために用いられる。&lt;/p&gt;
&lt;h2&gt;今回のきっかけ&lt;/h2&gt;
&lt;p&gt;ChIP-seqの解析をする時に便利なフォーマットにbigwigがある。igvで表示したり、coverageを計算したり、様々な用途で使える。詳しくはdrbonobon（第一版）のp118に記載されている。ChIP-seqの解析には&lt;a href="https://github.com/taoliu/MACS"&gt;MACS2&lt;/a&gt;というソフトが良く使われ、bigwigの生成も可能だが、&lt;a href="https://deeptools.readthedocs.io/en/develop/index.html"&gt;deepTools&lt;/a&gt;でも&lt;code&gt;​bamCoverage&lt;/code&gt;や​&lt;code&gt;​bamComapre&lt;/code&gt;機能を使ってbigwigを作ることができる。挙動や使い所の違いを比較しようというのが今回の目的。&lt;/p&gt;
&lt;p&gt;ちなみに、通常のChIP-seq解析ならMACS2,HOMERなどを使ってやるのが無難かと思います。今回はdeeptToolsと戯れたかった。&lt;/p&gt;
&lt;h2&gt;Install&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ conda install -c bioconda deeptools

$ conda create -n py27_macs2 &lt;span class="nv"&gt;python&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.7.5
$ conda activate py27_macs2
$ conda install -c bioconda macs2
$ conda install -c bioconda bedtools
$ conda install -c bioconda ucsc-bedgraphtobigwig
$ conda install -c bioconda ucsc-bedclip
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;condaでmacs2を入れようとするとxonshとdependency conflictしてしまった。諦めて仮想環境を作る。condaは入ってる前提。MACS2はいまだにpython2な時点で腰が引けるが、先に進む。&lt;/p&gt;
&lt;p&gt;※ python2.7.4以前だとエラーを吐くらしいので、python2.7.5にしてある。今考えると2.7.15でも良かったかもしれない。&lt;/p&gt;
&lt;h2&gt;今回使うsample&lt;/h2&gt;
&lt;p&gt;うちのラボの論文のデータを使ってみます。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Kitagawa, Y. et al. Guidance of regulatory T cell development by Satb1-dependent super-enhancer establishment. Nat. Immunol. 18, (2016).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ここからH3K27acのTregとTconvを使ってみます。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;SRR ID&lt;/th&gt;
&lt;th&gt;sample&lt;/th&gt;
&lt;th&gt;replicate&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;SRR5385260&lt;/td&gt;
&lt;td&gt;input&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SRR5385344&lt;/td&gt;
&lt;td&gt;Treg H3K27ac&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SRR5385345&lt;/td&gt;
&lt;td&gt;Treg H3K27ac&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SRR5385346&lt;/td&gt;
&lt;td&gt;Tconv H3K27ac&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SRR5385347&lt;/td&gt;
&lt;td&gt;Tconv H3K27ac&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;これらをお馴染みpfastq-dumpをつかって落としてきます。今回はSingle-endなのでsplitはいりません。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ mkdir data
$ prefetch SRR5385260 SRR5385344 SRR5385345 SRR5385346 SRR5385347
$ bash pfd.sh
$ fastqc -t &lt;span class="m"&gt;22&lt;/span&gt; -o data data/*.fastq
$ multiqc -n multiqc_report_raw.html ./data
$ bash make_bam.sh
$ fastqc -t &lt;span class="m"&gt;22&lt;/span&gt; -o data data/*.trimmed.fastq
$ multiqc -n multiqc_report_trimmed.html ./data
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;pdf.sh&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="nv"&gt;sras&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;SRR5385260&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SRR5385344&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SRR5385345&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SRR5385346&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SRR5385347&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; s in &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;sras&lt;/span&gt;&lt;span class="p"&gt;[@]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
pfastq-dump --threads &lt;span class="m"&gt;22&lt;/span&gt; --outdir data ~/ncbi/public/sra/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;s&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.sra
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;make_bam.sh&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="nv"&gt;sras&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;SRR5385260&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SRR5385344&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SRR5385345&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SRR5385346&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SRR5385347&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; s in &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;sras&lt;/span&gt;&lt;span class="p"&gt;[@]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
trimmomatic &lt;span class="se"&gt;\&lt;/span&gt;
    SE                  &lt;span class="se"&gt;\&lt;/span&gt;
    -threads &lt;span class="m"&gt;22&lt;/span&gt;         &lt;span class="se"&gt;\&lt;/span&gt;
    -phred33            &lt;span class="se"&gt;\&lt;/span&gt;
    -trimlog log.&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;s&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.txt    &lt;span class="se"&gt;\&lt;/span&gt;
    data/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;s&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.fastq            &lt;span class="se"&gt;\&lt;/span&gt;
    data/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;s&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.trimmed.fastq          &lt;span class="se"&gt;\&lt;/span&gt;
    ILLUMINACLIP:adapters.fa:2:10:10  &lt;span class="se"&gt;\&lt;/span&gt;
    LEADING:20 &lt;span class="se"&gt;\&lt;/span&gt;
    TRAILING:20 &lt;span class="se"&gt;\&lt;/span&gt;
    MINLEN:30
bowtie2 -p &lt;span class="m"&gt;22&lt;/span&gt; -x ~/ref_sequence/bowtie2_indexes/mm10 -U data/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;s&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.trimmed.fastq -S data/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;s&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.trimmed.sam &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt; data/out.&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;s&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.txt
samtools sort -O bam -o data/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;s&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.trimmed.bam data/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;s&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.trimmed.sam
samtools index data/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;s&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.trimmed.bam data/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;s&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.trimmed.bai
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;改行とコメントがうまく共存できなかったので、以下に注釈付きを示す。より詳しいことはおなじみ&lt;a href="https://bi.biopapyrus.jp/rnaseq/qc/trimmomatic.html"&gt;biopnpyrus&lt;/a&gt;を参照。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;trimmomatic \
    SE                  \  # single-end
    -threads 22         \  # スレッド数
    -phred33            \  # phred33 または -phred64 を指定
    -trimlog log.&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;.txt    \  # 実行ログの保存先
    data/&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;.fastq            \  # 入力 FASTQ
    data/&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;.trimmed.fastq          \  # 出力 FASTQ
    ILLUMINACLIP:adapters.fa:2:10:10  \ # アダプター除去条件の指定
    LEADING:20 \
    TRAILING:20 \
    MINLEN: 30   # 30bp を満たさないリードを除去
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;これでbamファイルが出来ているはず。&lt;/p&gt;
&lt;p&gt;igvで表示してみるとこんな感じ。
&lt;img alt="1" src="/previews/refs/heads/feature/category_pages/blog/2018/10/images/macs2_deeptools_figs/screenshot-from-2018-10-28-20-04-52.png"&gt;&lt;/p&gt;
&lt;h3&gt;補足 prefetchのoutputを変更する方法（Yoshiharaさんより）&lt;/h3&gt;
&lt;p&gt;デフォルトではプロジェクトのディレクトリの外にsraファイルを保存してしまう。また、データ用のストレージを分けている際もそちらに書き出してやりたい。そこでprefetchのoutputを変更したいという話になるわけだが、やり方は2つ。&lt;/p&gt;
&lt;h4&gt;1)&lt;/h4&gt;
&lt;p&gt;&lt;a href="https://github.com/ncbi/sra-tools/wiki/Toolkit-Configuration"&gt;Toolkit-Configuration&lt;/a&gt;をいじる方法。
公式にはこちらが推奨らしいが操作が面倒。&lt;/p&gt;
&lt;h4&gt;2)&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; ‘/repository/user/main/public/root &lt;span class="o"&gt;=&lt;/span&gt; “/outputDir”‘ &amp;gt; ~/.ncbi/user-settings.mkfg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;こっちのほうが簡単。outputDirに指定してやって下さい。
この例だとpfastq-dumpでは&lt;code&gt;~/ncbi/public/sra/${s}.sra&lt;/code&gt; が &lt;code&gt;/outputDir/sra/${s}.sra&lt;/code&gt;になりますね。&lt;/p&gt;
&lt;h2&gt;MACS2によるピークコール&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Zhang, Y. et al. Model-based Analysis of ChIP-Seq (MACS). Genome Biol. 9, R137 (2008).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ChIP-seq解析の定番ツールであるMACS2を使う。説明は&lt;a href="https://github.com/taoliu/MACS/wiki"&gt;公式wiki&lt;/a&gt;が詳しい。bigwigはpeakcallの副産物的な扱いで、メインはChIP-seqのピーク情報。bigwigは少し回りくどい作り方が必要。詳しくは&lt;a href="https://github.com/taoliu/MACS/wiki/Build-Signal-Track"&gt;こちら&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;まずはbdg2bwを用意する。&lt;code&gt;~/Programs&lt;/code&gt;はpathの通ったディレクトリとする。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ vim ~/Programs/bdg2bw &lt;span class="c1"&gt;# emacsでも。中身は以下。&lt;/span&gt;
$ chmod &lt;span class="m"&gt;755&lt;/span&gt; ~/Programs/bdg2bw
$ wget http://hgdownload.cse.ucsc.edu/goldenPath/mm10/database/chromInfo.txt.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;bdg2bw&lt;/code&gt;の中身は以下。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="c1"&gt;# check commands: slopBed, bedGraphToBigWig and bedClip&lt;/span&gt;

which bedtools &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;/dev/null &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;bedtools not found! Download bedTools: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;
which bedGraphToBigWig &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;/dev/null &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;bedGraphToBigWig not found! Download: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;
which bedClip &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;/dev/null &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;bedClip not found! Download: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;# end of checking&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="nv"&gt;$#&lt;/span&gt; -lt &lt;span class="m"&gt;2&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Need 2 parameters!  &amp;quot;&lt;/span&gt;
    &lt;span class="nb"&gt;exit&lt;/span&gt;
&lt;span class="k"&gt;fi&lt;/span&gt;

&lt;span class="nv"&gt;F&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;
&lt;span class="nv"&gt;G&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$2&lt;/span&gt;

bedtools slop -i &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;F&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; -g &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;G&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; -b &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; bedClip stdin &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;G&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;F&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.clip

&lt;span class="nv"&gt;LC_COLLATE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;C sort -k1,1 -k2,2n &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;F&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.clip &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;F&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.sort.clip

bedGraphToBigWig &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;F&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.sort.clip &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;G&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;F&lt;/span&gt;&lt;span class="p"&gt;/bdg/bw&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;

rm -f &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;F&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.clip &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;F&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.sort.clip
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;これで実行準備が整った。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ conda activate py27_macs2
$ mkdir macs2 &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; macs2
$ macs2 callpeak -t ../data/SRR5385344.trimmed.bam -c ../data/SRR5385260.trimmed.bam -g mm -n Treg_H3K27ac_1 -p 1e-5 -f BAM -B --nomodel &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt; macs.SRR5385344.out &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt; bdg2bw Treg_H3K27ac_1_treat_pileup.bdg ../chromInfo.txt
$ macs2 callpeak -t ../data/SRR5385345.trimmed.bam -c ../data/SRR5385260.trimmed.bam -g mm -n Treg_H3K27ac_2 -p 1e-5 -f BAM -B --nomodel &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt; macs.SRR5385345.out &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt; bdg2bw Treg_H3K27ac_2_treat_pileup.bdg ../chromInfo.txt
$ macs2 callpeak -t ../data/SRR5385346.trimmed.bam -c ../data/SRR5385260.trimmed.bam -g mm -n Tconv_H3K27ac_1 -p 1e-5 -f BAM -B --nomodel &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt; macs.SRR5385346.out &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt; bdg2bw Tconv_H3K27ac_1_treat_pileup.bdg ../chromInfo.txt
$ macs2 callpeak -t ../data/SRR5385347.trimmed.bam -c ../data/SRR5385260.trimmed.bam -g mm -n Tconv_H3K27ac_2 -p 1e-5 -f BAM -B --nomodel &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt; macs.SRR5385347.out &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt; bdg2bw Tconv_H3K27ac_2_treat_pileup.bdg ../chromInfo.txt
$ &lt;span class="nb"&gt;cd&lt;/span&gt; ..
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;-B&lt;/code&gt;でbdgというbedgraphファイルを保存するかどうか。
&lt;code&gt;--nomodel&lt;/code&gt;はshifting modelを作るかどうか。defaultでshiftは100。
実際はigvにはbdgファイルも読み込めてしまうので、特にbigwigにする必要はなかった。&lt;/p&gt;
&lt;h2&gt;deepToolsによるbwファイルの生成&lt;/h2&gt;
&lt;p&gt;&lt;img alt="1" src="/previews/refs/heads/feature/category_pages/blog/2018/10/images/macs2_deeptools_figs/start_workflow1.png"&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ramírez, F. et al. deepTools2: a next generation web server for deep-sequencing data analysis. Nucleic Acids Res. 44, W160–W165 (2016).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;MAX PLANCK INSTITUTE製のツールで、ChIP-seq, RNA-seq, MNase-seqなどに使えるツールとされている。多サンプルの比較などに向いている。QCや美しいvisualizationが可能。さらにdeepBlueの大量のデータも使える。CLIではもちろんのこと、Galaxyにも対応しているので、そちらでもいいし、Pythonで書かれていてAPIのドキュメントも手厚いのでそちらを使ってもいい。（ちょっとむずかしい。）&lt;/p&gt;
&lt;p&gt;今回はinputがあるので&lt;code&gt;bamCompare&lt;/code&gt;を使う。log2ratioがbwファイルに出力される。果たしていけるのか。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;bamCompare&lt;/code&gt;は&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;サンプルごとのスケーリング、depthの正規化&lt;/li&gt;
&lt;li&gt;operation(defaultはlog2ratio)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;を行う。binはdefaultで50bp。log2ratioの代わりにlog2, ratio, subtract, add, mean, reciprocal_ratio, first, secondを取得することもできる。今回はsubtract(差分)も合わせて取得してみる。macs2と違ってmultiprocessも動くが、bamのindexが先に必要。macs2に比べるととてもsimpleでよい。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ mkdir deepTools    
$ bamCompare -p &lt;span class="m"&gt;22&lt;/span&gt; -b1 ./data/SRR5385344.trimmed.bam -b2 ./data/SRR5385260.trimmed.bam -o deepTools/Treg_H3K27ac_1_log2ratio.bw
$ bamCompare -p &lt;span class="m"&gt;22&lt;/span&gt; -b1 ./data/SRR5385345.trimmed.bam -b2 ./data/SRR5385260.trimmed.bam -o deepTools/Treg_H3K27ac_2_log2ratio.bw
$ bamCompare -p &lt;span class="m"&gt;22&lt;/span&gt; -b1 ./data/SRR5385346.trimmed.bam -b2 ./data/SRR5385260.trimmed.bam -o deepTools/Tconv_H3K27ac_1_log2ratio.bw
$ bamCompare -p &lt;span class="m"&gt;22&lt;/span&gt; -b1 ./data/SRR5385347.trimmed.bam -b2 ./data/SRR5385260.trimmed.bam -o deepTools/Tconv_H3K27ac_2_log2ratio.bw

$ bamCompare -p &lt;span class="m"&gt;22&lt;/span&gt; --operation subtract -b1 ./data/SRR5385344.trimmed.bam -b2 ./data/SRR5385260.trimmed.bam -o deepTools/Treg_H3K27ac_1_subtract.bw
$ bamCompare -p &lt;span class="m"&gt;22&lt;/span&gt; --operation subtract -b1 ./data/SRR5385345.trimmed.bam -b2 ./data/SRR5385260.trimmed.bam -o deepTools/Treg_H3K27ac_2_subtract.bw
$ bamCompare -p &lt;span class="m"&gt;22&lt;/span&gt; --operation subtract -b1 ./data/SRR5385346.trimmed.bam -b2 ./data/SRR5385260.trimmed.bam -o deepTools/Tconv_H3K27ac_1_subtract.bw
$ bamCompare -p &lt;span class="m"&gt;22&lt;/span&gt; --operation subtract -b1 ./data/SRR5385347.trimmed.bam -b2 ./data/SRR5385260.trimmed.bam -o deepTools/Tconv_H3K27ac_2_subtract.bw
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;※ 181107 subtractのoutput fileが間違えていたので修正しました。（Yoshiharaさんより）&lt;/p&gt;
&lt;h2&gt;igvによる比較&lt;/h2&gt;
&lt;p&gt;&lt;img alt="1" src="/previews/refs/heads/feature/category_pages/blog/2018/10/images/macs2_deeptools_figs/screenshot-from-2018-10-28-20-36-19.png"&gt;&lt;/p&gt;
&lt;p&gt;上からmacs2, deepTools subtract, deepTools log2 fold changeになっている。macs2の結果はdeepToolsのsubtractに近いことがわかる。&lt;/p&gt;
&lt;p&gt;macs2のsummits.bedとnarrowPeakも表示してみた（下2つ）。これはこれで取り回しが効いて良い。narrowPeakはp valueに応じて色が変わっている。&lt;/p&gt;
&lt;p&gt;deepToolsが少しギザギザしているように見えるが、binを変えると細かくできる。&lt;/p&gt;
&lt;h2&gt;おまけ：deepToolsによる可視化&lt;/h2&gt;
&lt;p&gt;最後に、deepToolsの豊富な可視化機能の一部を試してみる。まず、&lt;a href="http://genome.ucsc.edu/cgi-bin/hgTables"&gt;UCSC&lt;/a&gt;よりmm10の遺伝子のbedを取得する。bigwigを用いた可視化は&lt;code&gt;computeMatrix&lt;/code&gt;した後&lt;code&gt;plotHeatmap&lt;/code&gt;などである。log2 fold changeのbigwigを用いて全遺伝子についてH3K27acのheatmapを書き、クラスタリングも同時にしてみる。全遺伝子についてなので&lt;code&gt;computeMatrix&lt;/code&gt;がとても重たくなってしまった。Tconvについては今回は省略。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ computeMatrix scale-regions &lt;span class="se"&gt;\&lt;/span&gt;
-S Treg_H3K27ac_1_log2ratio.bw Treg_H3K27ac_2_log2ratio.bw &lt;span class="se"&gt;\&lt;/span&gt;
-R mm10.genes.bed &lt;span class="se"&gt;\&lt;/span&gt;
--beforeRegionStartLength &lt;span class="m"&gt;3000&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
--regionBodyLength &lt;span class="m"&gt;5000&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
--afterRegionStartLength &lt;span class="m"&gt;3000&lt;/span&gt; --skipZeros -o matrix.mat.Treg.gz -p &lt;span class="m"&gt;8&lt;/span&gt;

&lt;span class="c1"&gt;# 赤が正になってほしいので_rでリバースする。&lt;/span&gt;
$ plotHeatmap -m matrix.mat.Treg.gz -out Heatmap.png &lt;span class="se"&gt;\&lt;/span&gt;
--colorMap RdYlBu_r --zMin -3 --zMax &lt;span class="m"&gt;3&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
--kmeans &lt;span class="m"&gt;4&lt;/span&gt; --samplesLabel Treg_H3K27ac_1  Treg_H3K27ac_2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="1" src="/previews/refs/heads/feature/category_pages/blog/2018/10/images/macs2_deeptools_figs/heatmap-3.png"&gt;&lt;/p&gt;
&lt;p&gt;plotHeatmapのクラスタリングは複数のサンプルがある時は１つ目のサンプルでクラスタリングするみたい。せっかく他のサンプルもあるのだから、いろいろ混ぜてクラスタリングできたらいいな。
colormapは&lt;a href="https://matplotlib.org/examples/color/colormaps_reference.html"&gt;matplotlibでおなじみのもの&lt;/a&gt;である。fontsizeは変更する方法は見つからなかった。これは結構困りどころ。強いて言うならissueで自分で書いてみてねとの&lt;a href="https://github.com/deeptools/deepTools/issues/444"&gt;回答&lt;/a&gt;があった。&lt;/p&gt;
&lt;p&gt;deepToolsに関して、いつもお世話になっている&lt;a href="http://kazumaxneo.hatenablog.com/entry/2018/06/25/210934"&gt;macでインフォマティクス&lt;/a&gt;さんにも記事があった。とても詳しい。他にもいろいろな機能があったので是非。&lt;/p&gt;
&lt;h2&gt;感想&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;macs2はpeakcallを目的にしていて、副産物としてbigwigやbdgが出力される。deepToolsは複数のChIP-seqデータなどを扱うのに長けている。逆にdeepToolsはpeak call機能がない。&lt;/li&gt;
&lt;li&gt;deepToolsはIHECのQCに使われていたり、bw作成後のdownstream解析もできたり、&lt;a href="https://www.nature.com/articles/s41467-018-02866-0"&gt;RamDA-seq&lt;/a&gt;の解析に使われていたりと、頼れるツールの様なので、早いうちにマスターしようと思う。&lt;/li&gt;
&lt;li&gt;TregとTconvのデータを用意した割にはTreg-specific peaksを見るところまでは手が回らなかった。（論文読めば書いてあるが。)特異的ピーク検出をするなら&lt;a href="http://homer.ucsd.edu/homer/ngs/index.html"&gt;HOMER&lt;/a&gt;が安定感があって良さそうな。&lt;/li&gt;
&lt;li&gt;ChIP-seq解析のいい練習になりました。&lt;/li&gt;
&lt;li&gt;multi-omics人材になるぞ！&lt;/li&gt;
&lt;/ul&gt;</content><category term="Blog"></category><category term="Bioinformatics"></category></entry><entry><title>LinuxでのBioinformatics環境構築</title><link href="/previews/refs/heads/feature/category_pages/blog/2018/10/environment_bioinformatics.html" rel="alternate"></link><published>2018-10-16T00:00:00+09:00</published><updated>2018-10-16T00:00:00+09:00</updated><author><name>平岡</name></author><id>tag:None,2018-10-16:/previews/refs/heads/feature/category_pages/blog/2018/10/environment_bioinformatics.html</id><summary type="html"></summary><content type="html">&lt;p&gt;ただいま、私のMacbook Proが入院しておりまして、古いWindows10をUbuntuとデュアルブートして作業しております。下級生でもWindowsしか持っていない、でもBioinformaticsに関心があるという人が、スムーズに環境構築できるようにと今回の記事を書きます。なお、前提として、Ubuntuのインストールが完了しているものとします。なお、筆者のインストールしたUbuntuは18.04.1 LTSです。&lt;/p&gt;
&lt;p&gt;今回は&lt;a href="https://oumpy.github.io/articles/2018/10/kallisto_rnaseq_pipeline.html"&gt;Kallistoを用いたRNA-seq解析パイプライン&lt;/a&gt;で使う、RNA-seq系のツールのインストールを行っていきますが、順次別の解析目的のツールインストールも紹介したいと考えております。今回の環境構築で、Kallistoを用いたRNA-seq解析パイプラインに進むことができます。&lt;/p&gt;
&lt;h2&gt;Pythonのインストール&lt;/h2&gt;
&lt;p&gt;Ubuntuのバージョンによってはpython2.7がデフォルトとなっている場合もあるので、python3系をダウンロードし、デフォルトに設定しよう。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# check the version of python.&lt;/span&gt;
$ python --version
&amp;gt;&amp;gt;&amp;gt; Python &lt;span class="m"&gt;2&lt;/span&gt;.7.15rc1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Biocondaのインストール&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://www.anaconda.com/download/#macos"&gt;Anaconda&lt;/a&gt;のインストーラーをダウンロードします。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ bash ~/Downloads/Anaconda3-4.1.0-Linux-x86_64.sh
$ &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;export PATH=/home/user/anaconda3/bin:$PATH&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt; ~/.bashrc
$ conda -V
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ python --version
&amp;gt;&amp;gt;&amp;gt; Python &lt;span class="m"&gt;3&lt;/span&gt;.6.6+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;バイオインフォマティクスの分野では解析のために様々なツールを利用しますが、インストールのたびにパスを通すなどの作業をしていると大変煩雑ですし、バージョン管理もしにくくなります。パッケージマネージャーを使ってツールを一元管理するのが賢明です。
Homebrewなどのパッケージ管理システムは有名ですが、対応していないツールの多く、現状はBiocondaというパッケージマネージャーがおすすめです。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# Download a Miniconda package for linux python3&lt;/span&gt;
$ wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
$ bash Miniconda3-latest-Linux-x86_64.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;EnterやYesを入力していくとインストールが終了し、パスも通った状態になります。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# condaコマンドが正常に動作していれば成功です。（terminalを開き直しましょう。）&lt;/span&gt;
$ conda -h
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;biocondaのチャンネルを追加。biocondaチャンネルが最上位に来るように設定。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ conda config --add channels conda-forge
$ conda config --add channels defaults
$ conda config --add channels r
$ conda config --add channels bioconda
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;それでは早速ツールをインストールしていきましょう。基本 &lt;code&gt;conda install ???&lt;/code&gt;でインストールが完了し正常に動作していきます。非常に便利ですね。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ conda install parallel-fastq-dump
$ conda install fastqc
$ conda install multiqc
$ conda install trimmomatic
$ conda install kallisto
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;参照&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://imamachi-n.hatenablog.com/entry/2017/01/14/212719"&gt;http://imamachi-n.hatenablog.com/entry/2017/01/14/212719&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Rツールのインストール&lt;/h2&gt;
&lt;p&gt;Rのコンソールを開いて、Rのツールをインストールしていきます。
Tximportのインストール&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://bioconductor.org/biocLite.R&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;biocLite&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;tximport&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;DESeq2のインストール&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://bioconductor.org/biocLite.R&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;biocLite&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;DESeq2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;参照&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://bioconductor.org/packages/release/bioc/html/tximport.html"&gt;https://bioconductor.org/packages/release/bioc/html/tximport.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://bioconductor.org/packages/release/bioc/html/DESeq2.html"&gt;https://bioconductor.org/packages/release/bioc/html/DESeq2.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="Blog"></category><category term="Bioinformatics"></category></entry><entry><title>Kallistoを用いたRNA-seq解析パイプライン</title><link href="/previews/refs/heads/feature/category_pages/blog/2018/10/kallisto_rnaseq_pipeline.html" rel="alternate"></link><published>2018-10-16T00:00:00+09:00</published><updated>2018-10-16T00:00:00+09:00</updated><author><name>平岡</name></author><id>tag:None,2018-10-16:/previews/refs/heads/feature/category_pages/blog/2018/10/kallisto_rnaseq_pipeline.html</id><summary type="html"></summary><content type="html">&lt;p&gt;今回はKallistoを用いたRNA-seq解析パイプラインを紹介します。&lt;a href="https://oumpy.github.io/articles/2018/10/environment_bioinformatics.html"&gt;LinuxでのBioinformatics環境構築&lt;/a&gt;でこの記事への準備はすべて終了している流れになります。&lt;a href="https://ja.wikipedia.org/wiki/%E3%82%AB%E3%83%AA%E3%82%B9%E3%83%88_(%E5%B0%8F%E6%83%91%E6%98%9F)"&gt;Kallisto&lt;/a&gt;は小惑星の名前のようです。つっこみどころありましたら、コメントいただけると嬉しいです！それではいきましょう！&lt;/p&gt;
&lt;h2&gt;リファレンスのダウンロード&lt;/h2&gt;
&lt;p&gt;kallistoでは、transcriptにシュードアラインメントするので、リファレンスにはcDNAを用います。今回は&lt;a href="https://www.gencodegenes.org/"&gt;GenCodeGenes&lt;/a&gt;のヒトtranscript sequencesのデータを用いました。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ wget ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_29/gencode.v29.transcripts.fa.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;FASTQファイルをダウンロードする場合&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://www.ebi.ac.uk/arrayexpress/"&gt;ArrayExpress&lt;/a&gt;からFASTQファイルをダウンロード、解凍する。今回のデータは、ヒトES細胞と成熟膵島細胞のデータ。single-end readとなっている。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR266/ERR266335/ERR266335.fastq.gz
$ gunzip ERR266335.fastq.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ERR266349 ERR266351 ERR266338 ERR266347についても同様に！&lt;/p&gt;
&lt;h3&gt;参照：&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;次世代シークエンサーDRY解析教本 (細胞工学別冊)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;SRAファイルをダウンロードする場合&lt;/h2&gt;
&lt;p&gt;DDBJの&lt;a href="https://ddbj.nig.ac.jp/DRASearch/"&gt;DRA search&lt;/a&gt;からSRAファイルをダウンロード、SRAファイルをFASTQに変換する。pfast-dumpで .sraをペアエンド.fastqに変換。 (&lt;strong&gt;kallistoはsraファイルを扱えない&lt;/strong&gt; ので、pfastq-dumpでfastqに変換する必要がある。）&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c1"&gt;# download sra files.&lt;/span&gt;
mkdir sra-fastq
&lt;span class="nv"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;ERR266335 ERR266337 ERR266338 ERR266347 ERR266349 ERR266351&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; item in &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;id&lt;/span&gt;&lt;span class="p"&gt;[@]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; start download &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;item&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.sra
wget ftp://ftp.ddbj.nig.ac.jp/ddbj_database/dra/sralite/ByExp/litesra/ERX/ERX182/ERX182652/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;item&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;item&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.sra
pfastq-dump -s &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;item&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; -t &lt;span class="m"&gt;8&lt;/span&gt; -O sra-fastq
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;pfastq-dumpのオプション&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-s&lt;/code&gt; : SRAファイルのID&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-t&lt;/code&gt; : スレッド数&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-O&lt;/code&gt; : 出力ファイル&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;今回はSRAファイルのダウンロードとpfastq-dumpを使ってsraをfastqに変換する処理をシェルスクリプトを使って行いました。共通項のあるかつ時間のかかるterminalでの処理はシェルスクリプトを使うと便利です。&lt;/p&gt;
&lt;h3&gt;SRAファイルとは？&lt;/h3&gt;
&lt;p&gt;Sequence Read Archiveの略。（かつてはNGSにリードが短い特徴があったのでShort Read Archiveと呼ばれていた。）NGSの登場により配列の品質情報を塩基配列とともに記述形式であるFASTQ形式が使用されるようになった時にできたバイナリ形式のデータフォーマット。よってpfastq-dumpなどのツールでFASTQに変換することができる。&lt;a href="https://en.wikipedia.org/wiki/International_Nucleotide_Sequence_Database_Collaboration"&gt;INSDC&lt;/a&gt;、&lt;a href="https://en.wikipedia.org/wiki/European_Bioinformatics_Institute"&gt;EBI&lt;/a&gt;、&lt;a href="https://en.wikipedia.org/wiki/DNA_Data_Bank_of_Japan"&gt;DDBJ&lt;/a&gt;が共同で運営しているデータベース&lt;a href="https://en.wikipedia.org/wiki/Sequence_Read_Archive"&gt;SRA&lt;/a&gt;に保存してある。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ less ERR266335.sra
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;バイナリデータなので、SRAファイルの中をのぞいてみると下のようになる。
&lt;img alt="1" src="/previews/refs/heads/feature/category_pages/blog/2018/10/images/kallisto_rnaseq_pipeline_figs/screen-shot-2018-10-31-at-19-29-38.png"&gt;&lt;/p&gt;
&lt;h3&gt;pfastq-dumpとは？&lt;/h3&gt;
&lt;p&gt;fastq-dumpを並列処理するbashスクリプト。Sequence Read Archive（wiki）からダウンロードされたシーケンスデータ（SRAフォーマット ）をfastq-dumpの並列処理で素早くfastqに変換することができる。&lt;a href="https://github.com/inutanoOhta"&gt;Ohta&lt;/a&gt;さんが公開されている。&lt;/p&gt;
&lt;h2&gt;Fastqc&lt;/h2&gt;
&lt;p&gt;クオリティチェック。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;ERR266335 ERR266337 ERR266338 ERR266347 ERR266349 ERR266351&lt;span class="o"&gt;)&lt;/span&gt;
mkdir fastqc
&lt;span class="k"&gt;for&lt;/span&gt; item in &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;id&lt;/span&gt;&lt;span class="p"&gt;[@]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; start quality check &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;item&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
mkdir fastqc/fastqc_&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;item&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
fastqc -t &lt;span class="m"&gt;8&lt;/span&gt; -o fastqc/fastqc_&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;item&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; sra-fastq/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;item&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.fastq -f fastq
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;sra-fastq/${item}.fastq&lt;/code&gt;がインプットファイル。
fastqcのオプションについて&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-t&lt;/code&gt; : スレッド数。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-O&lt;/code&gt; : 解析結果の保存先のディレクトリを指定する。今回はfastqcというディレクトリを作ってそこに入れている。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-f&lt;/code&gt; : インプットファイルのフォーマット。bam, samにも対応。.fastq.gzもfastqで指定する。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;実行結果は下記のようになる。&lt;/p&gt;
&lt;p&gt;&lt;img alt="2" src="/previews/refs/heads/feature/category_pages/blog/2018/10/images/kallisto_rnaseq_pipeline_figs/screen-shot-2018-10-31-at-19-58-17.png"&gt;&lt;/p&gt;
&lt;p&gt;fastqcディレクトリをのぞいてみる。fastqcのなかに&lt;code&gt;fastqc_${item}&lt;/code&gt;というディレクトリが自動生成されている。&lt;/p&gt;
&lt;p&gt;&lt;img alt="3" src="/previews/refs/heads/feature/category_pages/blog/2018/10/images/kallisto_rnaseq_pipeline_figs/screen-shot-2018-10-31-at-20-05-02.png"&gt;&lt;/p&gt;
&lt;p&gt;fastqc_ERR266335の中をのぞいてみると。htmlファイルとzipファイルが生成されている。&lt;/p&gt;
&lt;p&gt;&lt;img alt="4" src="/previews/refs/heads/feature/category_pages/blog/2018/10/images/kallisto_rnaseq_pipeline_figs/screen-shot-2018-10-31-at-20-07-03.png"&gt;&lt;/p&gt;
&lt;p&gt;htmlファイルをブラウザで開くことができる。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ open ERR266335_fastqc.html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="5" src="/previews/refs/heads/feature/category_pages/blog/2018/10/images/kallisto_rnaseq_pipeline_figs/screen-shot-2018-10-31-at-20-09-37.png"&gt;&lt;/p&gt;
&lt;h3&gt;参照：&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;次世代シークエンサーDRY解析教本&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Multiqc&lt;/h2&gt;
&lt;p&gt;クオリティチェックの結果、ログファイルなどをまとめていい感じにレポートにしてくれるツール。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# After analysis, run Multiqc by commands below. You can create report.&lt;/span&gt;
$ multiqc .
$ open multiqc_report.html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;multiqcの実行により、関連ファイルが下記のように自動生成される。&lt;/p&gt;
&lt;p&gt;&lt;img alt="6" src="/previews/refs/heads/feature/category_pages/blog/2018/10/images/kallisto_rnaseq_pipeline_figs/screen-shot-2018-10-22-at-21-20-18.png"&gt;&lt;/p&gt;
&lt;p&gt;複数のリードのクオリティチェックの結果を同時に表示できる。&lt;/p&gt;
&lt;p&gt;&lt;img alt="7" src="/previews/refs/heads/feature/category_pages/blog/2018/10/images/kallisto_rnaseq_pipeline_figs/screen-shot-2018-10-31-at-20-02-17.png"&gt;&lt;/p&gt;
&lt;h3&gt;参照：&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://multiqc.info/"&gt;https://multiqc.info/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Trimmomatic&lt;/h2&gt;
&lt;p&gt;Java で書かれているアダプタートリミングツールである。 Trimmomatic はアダプターの除去のみならず、リードの末端から一定数の塩基をトリムしたりする、簡単なクオリティフィルタリングも行える。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ trimmomatic SE -phred33 ERR266335.fastq output_ERR266335.fastq ILLUMINACLIP:adapters.fa:2:30:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;SE&lt;/code&gt;オプションでsingle-end readを指定している。pair-end readでは、オプションでPEとかき、paired outputとunpaired outputの出力先２つを指定する必要がある。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ILLUMINACLIP : 除去するアダプター配列をFASTA形式で与える。そのあとにミスマッチ許容数、palindrome clip threshold、simple clip thresholdの順に指定していく。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;参照&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://bi.biopapyrus.jp/rnaseq/qc/trimmomatic.html"&gt;https://bi.biopapyrus.jp/rnaseq/qc/trimmomatic.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.usadellab.org/cms/?page=trimmomatic"&gt;http://www.usadellab.org/cms/?page=trimmomatic&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Single-end, Pair-endってなに？？&lt;/h2&gt;
&lt;p&gt;&lt;img alt="8" src="/previews/refs/heads/feature/category_pages/blog/2018/10/images/kallisto_rnaseq_pipeline_figs/img_1051.jpg"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="9" src="/previews/refs/heads/feature/category_pages/blog/2018/10/images/kallisto_rnaseq_pipeline_figs/img_1050.jpg"&gt;&lt;/p&gt;
&lt;p&gt;シーケンスする機器によって、cDNAのかた方のみ読む(single-end read)方法と両端を読む(pair-end read)方法があります。トリミング、アラインメントにおいて、single-endなのか、pair-endなのかを指定しあげる必要があります。&lt;/p&gt;
&lt;h2&gt;Kallisto&lt;/h2&gt;
&lt;p&gt;RNA-Seqデータ、またはより一般的にはハイスループットシーケンシングリードを用いて転写産物の量を定量化するためのプログラムである。&lt;/p&gt;
&lt;p&gt;kallisto や Salmon を利用して定量したデータを使って、edgeR や DESeq2 などで発現量の群間比較を行うことができる。この際に、Bioconductor の tximport パッケージを利用することで、簡単に kallisto/Salmon の定量結果を edgeR/DESEq2 に渡すことができる。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ &lt;span class="nb"&gt;time&lt;/span&gt; kallisto/kallisto index -i hsGRCh38_kallisto Homo_sapiens.GRCh38.rna.fa.gz
$ &lt;span class="nb"&gt;time&lt;/span&gt; kallisto/kallisto quant -i hsGRCh38_kallisto sra_fastqc/ERR266335.fastq -o ERR266335exp_kallisto
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;kallisto quantにおいて、&lt;strong&gt;-iと-oのオプションは強制&lt;/strong&gt; である。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-i&lt;/code&gt; :作成したインデックスの指定&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-o&lt;/code&gt; :出力結果の保存先&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;デフォルトではペアエンドを読もうとする&lt;/strong&gt; ので、シングルリードの場合は&lt;code&gt;--single&lt;/code&gt;オプションをつける。シングルの時は&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-s&lt;/code&gt; : Estimated standard deviation of fragment lengthシーケンシング用のライブラリー中のフラグメントの長さの偏差&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-l&lt;/code&gt; : Estimated average fragment lengthシーケンシング用のライブラリー中のフラグメントの長さの平均&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;のオプションを追加するのが必須となる。
(kallistoはsraファイルを扱えないので、pfastq-dumpでfastqに変換する必要があった。)
ERR266337 ERR266349 ERR266351 ERR266338 ERR266347も同様に&lt;code&gt;kallisto_quant.sh&lt;/code&gt;というシェルスクリプトを書き実行した。今回に限らず、時間がかかるかつ繰り返しの処理はシェルスクリプトを書くと良い（私もこれから練習します）。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nv"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;ERR266335 ERR266337 ERR266349 ERR266351 ERR266338 ERR266347&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; item in &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;id&lt;/span&gt;&lt;span class="p"&gt;[@]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; start mapping &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;item&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; with Kallisto
&lt;span class="nv"&gt;result_dir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;item&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;_exp_kallisto
kallisto/kallisto quant -i hsGRCh38_kallisto -o &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;item&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; --single -l &lt;span class="m"&gt;200&lt;/span&gt; -s &lt;span class="m"&gt;20&lt;/span&gt; -b &lt;span class="m"&gt;100&lt;/span&gt; sra_fastqc/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;item&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.fastq
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;abundance.tsv, target_id, length, eff_length, est_counts, tpm&lt;/p&gt;
&lt;h3&gt;参照&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://scilifelab.github.io/courses/rnaseq/labs/kallisto"&gt;https://scilifelab.github.io/courses/rnaseq/labs/kallisto&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://bi.biopapyrus.jp/rnaseq/mapping/kallisto/kallisto-single-end-reads.html"&gt;https://bi.biopapyrus.jp/rnaseq/mapping/kallisto/kallisto-single-end-reads.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://kazumaxneo.hatenablog.com/entry/2018/07/14/180503"&gt;http://kazumaxneo.hatenablog.com/entry/2018/07/14/180503&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://scilifelab.github.io/courses/rnaseq/labs/kallisto"&gt;https://scilifelab.github.io/courses/rnaseq/labs/kallisto&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;FPKM, RPKM, TPMとは？&lt;/h2&gt;
&lt;p&gt;転写産物にマッピングされるリードの数は、サンプル中の総リード数（sequence depth）と転写産物の長さに影響されるので、RNA-Seq データから得られたリードカウントデータは、そのまま転写産物（遺伝子）発現量を表すわけではない。そのため、RNA-Seq データから得られるリードカウントデータを転写産物発現量として利用するには、総リード数や転写産物長で補正する必要がある。&lt;/p&gt;
&lt;p&gt;補正計算として、かつてはFPKM,RPKMが用いられてきたが、現在ではかわりにTPMが用いられている。TPMではサンプルごとの値の合計が同じになるので、比較する目的のためにはTPMの方が都合が良い。&lt;/p&gt;
&lt;h3&gt;FPKM/RPKM の計算&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;FPKM : Fragments Per Kilobase of exon per Killion reads Mapped&lt;/li&gt;
&lt;li&gt;RPKM : Reads Per Kilobase of exon per Million mapped reads
&lt;div class="math"&gt;$$
FPKM_i = Y_i \frac{10^3}{L_i}\frac{10^6}{N}=\frac{Y_i}{L_i N}10^9
$$&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(N\)&lt;/span&gt;: リファレンスにマッピングできた全リード数&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(Y_i\)&lt;/span&gt;: そのうち転写産物 &lt;span class="math"&gt;\(i\)&lt;/span&gt; の領域にマッピングされたリード数&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(L_i\)&lt;/span&gt;: 転写産物 &lt;span class="math"&gt;\(i\)&lt;/span&gt; の長さ&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;TPMの計算&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;TPM : Transcripts Per Kilobase Million&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="math"&gt;$$
T_t = \frac{Y_t}{L_t}10^3
$$&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class="math"&gt;\(Y_t\)&lt;/span&gt; : 転写産物 &lt;span class="math"&gt;\(t\)&lt;/span&gt; にマッピングされたリードカウント&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(L_t\)&lt;/span&gt;:  転写産物 &lt;span class="math"&gt;\(t\)&lt;/span&gt; の長さ&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(T_t\)&lt;/span&gt;: 転写産物 &lt;span class="math"&gt;\(t\)&lt;/span&gt; の 1,000 bp あたりのリード数&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="math"&gt;$$
TPM_t = T_t \frac{10^6}{\sum_t T_t}
$$&lt;/div&gt;
&lt;p&gt;転写産物長による補正後の総リードカウントが 100 万となるように補正&lt;/p&gt;
&lt;h3&gt;参照&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://bi.biopapyrus.jp/rnaseq/analysis/normalizaiton/fpkm.html"&gt;bipapyrus fpkm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://bi.biopapyrus.jp/rnaseq/analysis/normalizaiton/tpm.html"&gt;bipapyrus tpm&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;

&lt;ul&gt;
&lt;li&gt;Tximport, DESeq2を用いた解析はコメントをいただき、ただ今編集中となっております。少々お待ちください。&lt;/li&gt;
&lt;/ul&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="Blog"></category><category term="Bioinformatics"></category></entry></feed>