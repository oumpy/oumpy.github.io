<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>大阪大学医学部 Python会 (テスト用ページ) - 西田</title><link href="/previews/refs/heads/feature/category_pages/" rel="alternate"></link><link href="/previews/refs/heads/feature/category_pages/feeds/author.xi-tian.atom.xml" rel="self"></link><id>/previews/refs/heads/feature/category_pages/</id><updated>2019-03-19T00:00:00+09:00</updated><subtitle>Now is better than never.</subtitle><entry><title>阪医Python会特製 RNA-seq pipeline ver. 1.0 リリース</title><link href="/previews/refs/heads/feature/category_pages/blog/2019/03/original_rnaseq_pipeline.html" rel="alternate"></link><published>2019-03-19T00:00:00+09:00</published><updated>2019-03-19T00:00:00+09:00</updated><author><name>菅波</name></author><id>tag:None,2019-03-19:/previews/refs/heads/feature/category_pages/blog/2019/03/original_rnaseq_pipeline.html</id><summary type="html"></summary><content type="html">&lt;p&gt;阪医Python会のbioinformaticsチームの一つの成果として、RNA-seqのパイプラインのv1.0がリリースとなったので記事とさせていただきます。SRR idから遺伝子✕サンプルのテーブルにするまでには意外に大変ですが、それをすべて自動化しました。ダウンロード、詳細等は以下にあります。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href="https://github.com/yyoshiaki/auto_counttable_maker"&gt;https://github.com/yyoshiaki/auto_counttable_maker&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;なお、以下のイラストはikraのアイコンとなっています。&lt;/p&gt;
&lt;p&gt;&lt;img src="/previews/refs/heads/feature/category_pages/blog/2019/03/images/original_rnaseq_pipeline_figs/ikra.png" width="250px"&gt; &lt;/p&gt;
&lt;h2&gt;特徴&lt;/h2&gt;
&lt;p&gt;今回、自分たちの使いやすさを考えてツールの設計を行いました。他サンプルのファイル名の管理など、煩わしいところをすべて自動化することで、ミスも減らせると思います。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;準備するのは簡単なCSVファイル（テーブルだけ）で、極力パラメーターを減らした。&lt;/li&gt;
&lt;li&gt;すべてdocker上で動くため、ツールを各々インストールする必要がないし、バージョンに苦しむこともない。&lt;/li&gt;
&lt;li&gt;udockerにも対応しているため、ユーザー権限しかないサーバー上でも実行可能。&lt;/li&gt;
&lt;li&gt;outputは&lt;a href="http://bioinformatics.sdstate.edu/idep/"&gt;idep&lt;/a&gt;に対応。&lt;/li&gt;
&lt;li&gt;もちろんマルチスレッド対応。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;使い方&lt;/h2&gt;
&lt;p&gt;必要なテーブルは&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;name&lt;/th&gt;
&lt;th&gt;SRR or fastq&lt;/th&gt;
&lt;th&gt;Layout&lt;/th&gt;
&lt;th&gt;condition1&lt;/th&gt;
&lt;th&gt;...&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Treg_LN_1&lt;/td&gt;
&lt;td&gt;SRR5385247&lt;/td&gt;
&lt;td&gt;SE&lt;/td&gt;
&lt;td&gt;Treg&lt;/td&gt;
&lt;td&gt;...&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Treg_LN_2&lt;/td&gt;
&lt;td&gt;SRR5385248&lt;/td&gt;
&lt;td&gt;SE&lt;/td&gt;
&lt;td&gt;Treg&lt;/td&gt;
&lt;td&gt;...&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;のような形式で、前3列が必須です。簡単ですね！データの集め方は、論文についているaccession number等をたどるのでもいいし、新しくなって爆速になった&lt;a href="http://sra.dbcls.jp/"&gt;DDBJ Search&lt;/a&gt;もおすすめ。&lt;/p&gt;
&lt;p&gt;コマンドはオプションが指定でき、リード数を100000に絞ったテストモードやマルチプロセスにも対応。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;Usage&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bash&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MakeCountTable_Illumina_trimgalore_SRR&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sh&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;experiment_table&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;csv&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;spiece&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;--test, --help, --without-docker, --udocker&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;--threads [VALUE&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="mf"&gt;1.&lt;/span&gt;&lt;span class="n"&gt;experiment&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;csv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="mf"&gt;2.&lt;/span&gt;&lt;span class="n"&gt;reference&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;human&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;or&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mouse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="nl"&gt;Options&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="c1"&gt;--test test mode(MAX_SPOT_ID=100000).(dafault : False)&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;--udocker&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;--without-docker&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;--threads&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;--help Show usage.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;なお、自前のfastq filesからの実行はv1.1で載せようと思っています。また、出力はscaled TPMを採用。(Soneson, C., Love, M. I. &amp;amp; Robinson, M. D. Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences. F1000Research 4, 1521 (2015).)。&lt;/p&gt;
&lt;h2&gt;pipelineの構成&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;fasterq-dump : シーケンスデータの取得&lt;/li&gt;
&lt;li&gt;fastqc : QC&lt;/li&gt;
&lt;li&gt;trim-galore : トリミング&lt;/li&gt;
&lt;li&gt;salmon : RNA定量&lt;/li&gt;
&lt;li&gt;multiqc : QCログの回収、可視化&lt;/li&gt;
&lt;li&gt;tximport : 遺伝子テーブルの生成&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;となっています。各ツールの説明は省きますが、今時のツールの選定になっていると思います。&lt;/p&gt;
&lt;h2&gt;idep&lt;/h2&gt;
&lt;p&gt;本ツールは&lt;a href="http://bioinformatics.sdstate.edu/idep/"&gt;idep&lt;/a&gt;を意識した設計になっています。idepはRNA-seqの解析をinteractiveに行えるプラットフォームで、Differential expressed genes(DEGs)の検出だけではなく、遺伝子、サンプルのクラスタリング、パスウェイ解析、可視化などが行えます。idepについては以下がとても参考になります。&lt;/p&gt;
&lt;p&gt;&lt;a href="http://kazumaxneo.hatenablog.com/entry/2018/12/29/153838"&gt;macでインフォマティクス : インタラクティブなRNA seq解析webアプリケーション iDEP&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="2" src="/previews/refs/heads/feature/category_pages/blog/2019/03/images/original_rnaseq_pipeline_figs/screenshot-from-2019-03-19-23-14-31.png"&gt;&lt;/p&gt;
&lt;h2&gt;githubを用いたチーム開発&lt;/h2&gt;
&lt;p&gt;今回、githubを用いてチーム開発を行いました。githubはエンジニアの間では当たり前のツールで、チームでのソフト開発によく用いられます。bioinformatics界隈でチーム開発を経験できることは意外に少なく、非常にいい経験になりました。&lt;/p&gt;
&lt;p&gt;&lt;img alt="3" src="/previews/refs/heads/feature/category_pages/blog/2019/03/images/original_rnaseq_pipeline_figs/ikra_git.png"&gt;&lt;/p&gt;
&lt;p&gt;雑多にはなりましたが、阪医Python会bioinformaticsチームの成果をアナウンスさせていただきました。完成までには3ヶ月ほどを要し、各人のアイデアや努力が詰まっております。今後もどんどん開発を進めていこうと思います。また、皆様のissue, Pull Requestもお待ちしております。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Enjoy bioinformatics life!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="4" src="/previews/refs/heads/feature/category_pages/blog/2019/03/images/original_rnaseq_pipeline_figs/ios-e381aee794bbe5838f.jpg"&gt;&lt;/p&gt;</content><category term="Blog"></category><category term="Bioinformatics"></category></entry><entry><title>Gene Set Enrichment Analysis (GSEA)入門</title><link href="/previews/refs/heads/feature/category_pages/blog/2018/11/gsea.html" rel="alternate"></link><published>2018-11-27T00:00:00+09:00</published><updated>2018-11-27T00:00:00+09:00</updated><author><name>西田</name></author><id>tag:None,2018-11-27:/previews/refs/heads/feature/category_pages/blog/2018/11/gsea.html</id><summary type="html"></summary><content type="html">&lt;h2&gt;GSEAとは&lt;/h2&gt;
&lt;p&gt;GSEAは発現差異解析の結果などで得られる遺伝子群がどういった機能のものかを明らかにするために用いられる解析手法です。機能表現として用いられる主なものとしてはKEGGのパスウェイ分類やGene Ontology(GO)があります。&lt;/p&gt;
&lt;h2&gt;clusterProfilerでGSEA入門&lt;/h2&gt;
&lt;p&gt;GSEA には様々なGSEAがあります。単に注目する遺伝子のリストをGSEAへの入力とするもの、発現プロファイルを入力とするもの、機能のデータベースやGSEA手法を複数組み合わせたりするもの (EGSEA) など様々です。[余談ですがGeneを代謝物(Metabolite)に置き換えたMSEAもあります。]&lt;/p&gt;
&lt;p&gt;ここでは前述したものの内、最初の「単に注目する遺伝子のリストをGSEAへの入力とするもの」をbioconductorのパッケージ clusterProfiler を用いて体験してみましょう。&lt;/p&gt;
&lt;p&gt;(clusterProfilerのインストールについては省略します。)&lt;/p&gt;
&lt;p&gt;まず注目する遺伝子のリストを下記で用意します。&lt;/p&gt;
&lt;p&gt;※編集注 : 以下はすべてRでの実行になります。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;geneList&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;package&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;DOSE&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;gene&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;geneList&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="nf"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;geneList&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;gene&lt;/span&gt;
  &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;4312&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;8318&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;10874&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;55143&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;55388&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;991&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;6280&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;2305&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9493&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1062&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3868&amp;quot;&lt;/span&gt;  
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;12&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;4605&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9833&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9133&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;6279&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;10403&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;8685&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;597&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;7153&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;23397&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;6278&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;79733&amp;quot;&lt;/span&gt;
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;259266&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1381&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3627&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;27074&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;6241&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;55165&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;9787&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;7368&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;11065&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;55355&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;9582&amp;quot;&lt;/span&gt;  
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;34&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;220134&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;55872&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;51203&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;3669&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;83461&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;22974&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;10460&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;10563&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4751&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;6373&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;8140&amp;quot;&lt;/span&gt;  
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;45&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;79019&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;820&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;10635&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;1844&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;4283&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;27299&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;55839&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;27338&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;890&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;9415&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;983&amp;quot;&lt;/span&gt;   
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;56&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;54821&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;10232&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4085&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;6362&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9837&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;5080&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;7850&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;81930&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;5918&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;81620&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;332&amp;quot;&lt;/span&gt;   
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;67&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;55765&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;79605&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;3832&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;6286&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;5163&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;2146&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3002&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;50852&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;7272&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;2568&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;64151&amp;quot;&lt;/span&gt;
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;78&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;51806&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;366&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;2842&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9212&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;140578&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;51659&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;8715&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;4902&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;8208&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1111&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9319&amp;quot;&lt;/span&gt;  
 &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;89&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;9055&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3833&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;146909&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;23475&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4321&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;11182&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;10112&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;3902&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3620&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3887&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;51514&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;6790&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;4521&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;891&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;57110&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;8544&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1448&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;24137&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;6355&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;10578&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4174&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9232&amp;quot;&lt;/span&gt;  
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;111&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;643314&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1307&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;776&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;4129&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;9370&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;196740&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;25924&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;8857&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1602&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;51161&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;3708&amp;quot;&lt;/span&gt;  
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;122&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;23090&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;10742&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;51760&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;9122&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;10699&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;8416&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;60598&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;79148&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;64799&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4629&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1556&amp;quot;&lt;/span&gt;  
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;133&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;55096&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;26289&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;6038&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;771&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;51313&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;23704&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;3117&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;80129&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;23158&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;125&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;4958&amp;quot;&lt;/span&gt;  
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;144&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;4857&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1311&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;5105&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;5174&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;730&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;2018&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;81563&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;2532&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1308&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;4250&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;23362&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;155&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;2167&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;51705&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;2593&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;652&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;80736&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4036&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;57502&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;5507&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;56521&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;22885&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4137&amp;quot;&lt;/span&gt;  
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;166&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;8483&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;8839&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;2066&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;4693&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;4148&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;79083&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;1101&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3158&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;3169&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;5346&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;1408&amp;quot;&lt;/span&gt;  
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;177&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;9547&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;2922&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;11283&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;64499&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;54829&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;1524&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;10234&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;1580&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;10647&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;25893&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;24141&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;188&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;10351&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;2330&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;5304&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;79846&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;8614&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;2625&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;7021&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;7802&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;79689&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;11122&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;55351&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;199&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;9&amp;quot;&lt;/span&gt;      &lt;span class="s"&gt;&amp;quot;4239&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;5241&amp;quot;&lt;/span&gt;   &lt;span class="s"&gt;&amp;quot;10551&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;10974&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;79838&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;79901&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;57758&amp;quot;&lt;/span&gt;  &lt;span class="s"&gt;&amp;quot;4969&amp;quot;&lt;/span&gt;  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;gene&lt;/code&gt;はヒト遺伝子のENTREZのIDです。&lt;/p&gt;
&lt;p&gt;この遺伝子リストを入力としてKEGGを対象としたGSEAを行ってみましょう。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nf"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clusterProfiler&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;kk&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;enrichKEGG&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gene&lt;/span&gt;         &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gene&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;+&lt;/span&gt;                  &lt;span class="n"&gt;organism&lt;/span&gt;     &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;hsa&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;+&lt;/span&gt;                  &lt;span class="n"&gt;pvalueCutoff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0.05&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kk&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
               &lt;span class="n"&gt;ID&lt;/span&gt;                             &lt;span class="n"&gt;Description&lt;/span&gt; &lt;span class="n"&gt;GeneRatio&lt;/span&gt;  &lt;span class="n"&gt;BgRatio&lt;/span&gt;       &lt;span class="n"&gt;pvalue&lt;/span&gt;     &lt;span class="n"&gt;p.adjust&lt;/span&gt;       &lt;span class="n"&gt;qvalue&lt;/span&gt;                                             &lt;span class="n"&gt;geneID&lt;/span&gt; &lt;span class="n"&gt;Count&lt;/span&gt;
&lt;span class="n"&gt;hsa04110&lt;/span&gt; &lt;span class="n"&gt;hsa04110&lt;/span&gt;                              &lt;span class="n"&gt;Cell&lt;/span&gt; &lt;span class="n"&gt;cycle&lt;/span&gt;     &lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;90&lt;/span&gt; &lt;span class="m"&gt;123&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;7469&lt;/span&gt; &lt;span class="m"&gt;2.135411e-07&lt;/span&gt; &lt;span class="m"&gt;0.0000409999&lt;/span&gt; &lt;span class="m"&gt;4.023565e-05&lt;/span&gt; &lt;span class="m"&gt;8318&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;991&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;9133&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;890&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;983&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;4085&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;7272&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;1111&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;891&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;4174&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;9232&lt;/span&gt;    &lt;span class="m"&gt;11&lt;/span&gt;
&lt;span class="n"&gt;hsa04114&lt;/span&gt; &lt;span class="n"&gt;hsa04114&lt;/span&gt;                          &lt;span class="n"&gt;Oocyte&lt;/span&gt; &lt;span class="n"&gt;meiosis&lt;/span&gt;     &lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;90&lt;/span&gt; &lt;span class="m"&gt;125&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;7469&lt;/span&gt; &lt;span class="m"&gt;2.216832e-06&lt;/span&gt; &lt;span class="m"&gt;0.0002128158&lt;/span&gt; &lt;span class="m"&gt;2.088489e-04&lt;/span&gt;    &lt;span class="m"&gt;991&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;9133&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;983&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;4085&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;51806&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;6790&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;891&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;9232&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;3708&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;5241&lt;/span&gt;    &lt;span class="m"&gt;10&lt;/span&gt;
&lt;span class="n"&gt;hsa04218&lt;/span&gt; &lt;span class="n"&gt;hsa04218&lt;/span&gt;                     &lt;span class="n"&gt;Cellular&lt;/span&gt; &lt;span class="n"&gt;senescence&lt;/span&gt;     &lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;90&lt;/span&gt; &lt;span class="m"&gt;160&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;7469&lt;/span&gt; &lt;span class="m"&gt;2.014286e-05&lt;/span&gt; &lt;span class="m"&gt;0.0012891427&lt;/span&gt; &lt;span class="m"&gt;1.265113e-03&lt;/span&gt;     &lt;span class="m"&gt;2305&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;4605&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;9133&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;890&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;983&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;51806&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;1111&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;891&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;776&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;3708&lt;/span&gt;    &lt;span class="m"&gt;10&lt;/span&gt;
&lt;span class="n"&gt;hsa03320&lt;/span&gt; &lt;span class="n"&gt;hsa03320&lt;/span&gt;                  &lt;span class="n"&gt;PPAR&lt;/span&gt; &lt;span class="n"&gt;signaling&lt;/span&gt; &lt;span class="n"&gt;pathway&lt;/span&gt;      &lt;span class="m"&gt;7&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;90&lt;/span&gt;  &lt;span class="m"&gt;74&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;7469&lt;/span&gt; &lt;span class="m"&gt;2.724093e-05&lt;/span&gt; &lt;span class="m"&gt;0.0013075646&lt;/span&gt; &lt;span class="m"&gt;1.283191e-03&lt;/span&gt;                 &lt;span class="m"&gt;4312&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;9415&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;9370&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;5105&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;2167&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;3158&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;5346&lt;/span&gt;     &lt;span class="m"&gt;7&lt;/span&gt;
&lt;span class="n"&gt;hsa04914&lt;/span&gt; &lt;span class="n"&gt;hsa04914&lt;/span&gt; &lt;span class="n"&gt;Progesterone&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;mediated&lt;/span&gt; &lt;span class="n"&gt;oocyte&lt;/span&gt; &lt;span class="n"&gt;maturation&lt;/span&gt;      &lt;span class="m"&gt;7&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;90&lt;/span&gt;  &lt;span class="m"&gt;98&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;7469&lt;/span&gt; &lt;span class="m"&gt;1.657604e-04&lt;/span&gt; &lt;span class="m"&gt;0.0063651988&lt;/span&gt; &lt;span class="m"&gt;6.246549e-03&lt;/span&gt;                    &lt;span class="m"&gt;9133&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;890&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;983&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;4085&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;6790&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;891&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;5241&lt;/span&gt;     &lt;span class="m"&gt;7&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;kk&lt;/code&gt; がGSEAの結果になります。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;head(kk)&lt;/code&gt; でGSEAの結果を上から確からしいもの順にトップ5を出力しています。&lt;/p&gt;
&lt;p&gt;もし遺伝子リスト&lt;code&gt;gene&lt;/code&gt;が発現差異解析の結果であるなら、コントロールとターゲット間で&lt;code&gt;Cell cycle&lt;/code&gt;等に異変が起きているだろう、とこの結果から推測できるということになります。&lt;/p&gt;
&lt;p&gt;次に&lt;code&gt;kk&lt;/code&gt;の各列名の意味ですが&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IDはKEGG pathwayのID&lt;/li&gt;
&lt;li&gt;DescriptionはKEGG pathwayの名前&lt;/li&gt;
&lt;li&gt;GeneRatioは入力&lt;code&gt;gene&lt;/code&gt;の遺伝子の内、何個の遺伝子がそのKEGG pathwayにマップされるか&lt;/li&gt;
&lt;li&gt;BgRatioは全KEGG pathwayにマップされる遺伝子の内、何個の遺伝子がそのKEGG pathwayにマップされるか&lt;/li&gt;
&lt;li&gt;p.adjust, qvalueは多重検定に伴う補正後のpvalueになり小さいほど確からしいことを示します。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;入力&lt;code&gt;gene&lt;/code&gt;に含まれる遺伝子がKEGG pathway上のどのgene productにmapされるかを可視化するには下記を実行します。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;browseKEGG(kk, &amp;#39;hsa04110&amp;#39;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="KEGG map" src="/previews/refs/heads/feature/category_pages/blog/2018/11/images/gsea_figs/null9.png"&gt;&lt;/p&gt;
&lt;h2&gt;終わりに&lt;/h2&gt;
&lt;p&gt;最も簡単なGSEAを体験していただく例を示しました。&lt;/p&gt;
&lt;p&gt;追ってより進んだアンサンブル手法なども紹介できればと思っています。&lt;/p&gt;</content><category term="Blog"></category><category term="Bioinformatics"></category></entry></feed>